
<!DOCTYPE html>
<html lang="en"> <!-- data-theme attribute will be added here by JS -->
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="The Well - A learning platform for spiritual growth and biblical studies">
  <title>The Well | Shiloh Temple House of God</title>
  <!-- Modern font integration -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
  <!-- Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
  <!-- Custom CSS -->
  <style>
    /* Loading Screen Styles - Placed early for immediate application */
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--background); /* Uses theme background */
      display: flex;
      flex-direction: column; /* To stack loader and optional text */
      align-items: center;
      justify-content: center;
      z-index: 9999; /* Ensures it's on top */
      opacity: 1;
      transition: opacity 0.75s ease-out; /* Smooth fade-out */
      pointer-events: auto; 
    }

    #loading-screen.hidden {
      opacity: 0;
      pointer-events: none; /* Prevent interaction after hidden */
    }

    .loader {
      border: 8px solid var(--divider); /* A lighter ring */
      border-top: 8px solid var(--primary); /* The moving part of the spinner */
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1.2s linear infinite;
      transition: border-color var(--transition-standard); /* For theme changes */
    }
    #loading-screen p { /* Optional: Style for loading text */
        margin-top: var(--spacing-md);
        font-size: 1.1rem;
        color: var(--text-secondary);
    }


    /* The keyframes for the spinner animation */
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    :root {
      /* Light Theme (Default) - Modern color palette - Blue Theme */
      --primary: #2d5282;
      --primary-dark: #1a365d;
      --primary-light: #4a69a7;
      --accent: #5cbbf6;
      --accent-dark: #3aa0e9;
      --success: #4CAF50;
      --warning: #FF9800;
      --error: #F44336;
      --background: #f9fafb;
      --surface: #ffffff;
      --surface-elevated: #ffffff;
      --surface-variant: #f0f2f5; /* Slightly off-white for hover states */
      --text-primary: #1a202c;
      --text-secondary: #4a5568;
      --text-tertiary: #718096;
      --text-on-primary: #FFFFFF;
      --text-on-secondary: #FFFFFF;
      --text-on-accent: #FFFFFF;
      --divider: #e2e8f0;
      
      /* Shadows */
      --card-shadow: 0 4px 20px rgba(0,0,0,0.08);
      --card-hover-shadow: 0 8px 30px rgba(0,0,0,0.12);
      --nav-shadow: 0 -2px 10px rgba(0,0,0,0.06);
      --header-shadow: 0 4px 20px rgba(0,0,0,0.1);
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
      --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
      --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);
      
      /* Gradients */
      --header-gradient: linear-gradient(135deg, #2d5282 0%, #1a365d 100%);
      
      /* Spacing Variables */
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
      --spacing-xxl: 48px;
      
      /* Border Radius */
      --radius-sm: 4px;
      --radius-md: 8px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-xxl: 32px;
      --radius-full: 9999px;
      
      /* Transitions */
      --transition-fast: 0.15s ease;
      --transition-standard: 0.3s ease;
      --transition-slow: 0.5s ease;
    }

    html[data-theme="dark"] {
      --primary: #5cbbf6; /* Using accent as primary for more pop in dark mode */
      --primary-dark: #3aa0e9;
      --primary-light: #8ed3f8;
      --accent: #2d5282; /* Original primary as accent */
      --accent-dark: #1a365d;

      --background: #111827; /* Darker background */
      --surface: #1f2937;    /* Surfaces like inputs, sidebars */
      --surface-elevated: #374151; /* Cards, modals */
      --surface-variant: #4b5563; /* Hover states on list items etc. */

      --text-primary: #f3f4f6;   /* Off-white */
      --text-secondary: #d1d5db; /* Light gray */
      --text-tertiary: #9ca3af;  /* Mid-light gray */
      
      --text-on-primary: #0F172A; /* Dark text on light blue primary */
      --text-on-accent: #FFFFFF;

      --divider: #4b5563; /* Darker divider */

      /* Shadows for dark mode */
      --card-shadow: 0 4px 15px rgba(0,0,0,0.3);
      --card-hover-shadow: 0 8px 25px rgba(0,0,0,0.4);
      --nav-shadow: 0 -2px 10px rgba(0,0,0,0.3);
      --header-shadow: 0 4px 15px rgba(0,0,0,0.35);
      --shadow-sm: 0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.4);
      --shadow-md: 0 4px 6px rgba(0,0,0,0.35);
      --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.35), 0 4px 6px -2px rgba(0,0,0,0.3);
      --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.35), 0 10px 10px -5px rgba(0,0,0,0.3);
      
      /* Gradients for dark mode */
      --header-gradient: linear-gradient(135deg, var(--primary-dark) 0%, #1f2937 100%);
    }

    /* Base styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--background);
      color: var(--text-primary);
      line-height: 1.6;
      font-size: 16px;
      font-weight: 400;
      padding-bottom: 80px; /* Space for bottom nav */
      overflow-x: hidden;
      transition: background-color var(--transition-standard), color var(--transition-standard);
    }

    /* Typography */
    h1, h2, h3, h4, h5, h6 {
      font-family: 'Playfair Display', serif;
      font-weight: 600;
      line-height: 1.3;
      margin-bottom: var(--spacing-md);
      color: var(--text-primary); 
      transition: color var(--transition-standard);
    }

    h1 { font-size: 2.5rem; }
    h2 { font-size: 2rem; }
    h3 { font-size: 1.75rem; position: relative; display: inline-block; }
    h3::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      width: 40px;
      height: 3px;
      background-color: var(--accent);
      border-radius: 2px;
      transition: background-color var(--transition-standard);
    }
    h4 { font-size: 1.5rem; }
    h5 { font-size: 1.25rem; }
    h6 { font-size: 1rem; }

    p { 
      margin-bottom: var(--spacing-md);
      color: var(--text-secondary); 
      transition: color var(--transition-standard);
    }

    a {
      color: var(--primary);
      text-decoration: none;
      transition: var(--transition-standard);
    }

    a:hover {
      color: var(--primary-light);
    }

    img {
      max-width: 100%;
      height: auto;
    }
    
    button, .nav-item {
      transition: color var(--transition-standard), background-color var(--transition-standard), border-color var(--transition-standard), opacity var(--transition-standard), transform 0.1s ease-out, box-shadow var(--transition-fast);
    }

    button:active, .nav-item:active {
      transform: scale(0.95); 
    }
    .theme-toggle-button { 
        transition: background-color 0.2s ease, color 0.2s ease, transform 0.1s ease-out;
    }
    
    input, textarea, select {
      background-color: var(--surface);
      color: var(--text-primary);
      border: 1px solid var(--divider);
      font-family: 'Poppins', sans-serif;
      padding: var(--spacing-sm);
      border-radius: var(--radius-sm);
      transition: background-color var(--transition-standard), color var(--transition-standard), border-color var(--transition-standard), box-shadow var(--transition-fast);
    }
    input::placeholder, textarea::placeholder {
      color: var(--text-tertiary);
      opacity: 0.7;
    }
    html[data-theme="dark"] input::placeholder,
    html[data-theme="dark"] textarea::placeholder {
      color: var(--text-tertiary);
      opacity: 0.7;
    }

    input:focus-visible, textarea:focus-visible, select:focus-visible {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 30%, transparent);
    }
    
    html[data-theme="dark"] input:-webkit-autofill,
    html[data-theme="dark"] input:-webkit-autofill:hover,
    html[data-theme="dark"] input:-webkit-autofill:focus,
    html[data-theme="dark"] textarea:-webkit-autofill,
    html[data-theme="dark"] textarea:-webkit-autofill:hover,
    html[data-theme="dark"] textarea:-webkit-autofill:focus,
    html[data-theme="dark"] select:-webkit-autofill,
    html[data-theme="dark"] select:-webkit-autofill:hover,
    html[data-theme="dark"] select:-webkit-autofill:focus {
      -webkit-text-fill-color: var(--text-primary);
      -webkit-box-shadow: 0 0 0px 1000px var(--surface) inset;
      caret-color: var(--text-primary);
    }

    /* Enhanced Focus Styles */
    button:focus-visible,
    .nav-item:focus-visible,
    .version-tab:focus-visible,
    .version-item:focus-visible,
    .note-item:focus-visible,
    .sabbath-lesson:focus-visible,
    .tag-pill:focus-visible, /* For tag pills */
    .card:focus-visible { /* If cards become interactive */
      outline: 2px solid var(--accent);
      outline-offset: 2px;
      box-shadow: 0 0 0 4px color-mix(in srgb, var(--accent) 30%, transparent);
      border-radius: var(--radius-sm); /* Ensure radius matches element for cleaner outline */
    }
    .card .favorite-button:focus-visible {
      outline: 2px solid var(--accent);
      outline-offset: -3px; /* Adjust to be inside or around the icon */
      box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 40%, transparent);
      border-radius: var(--radius-full);
    }


    .modal-close:focus-visible {
        outline: 2px solid var(--accent);
        outline-offset: 2px;
        box-shadow: 0 0 0 4px color-mix(in srgb, var(--accent) 50%, transparent);
        border-radius: var(--radius-full); /* Match button's border radius */
    }
    html[data-theme="dark"] .modal-close:focus-visible {
        outline-color: var(--primary-light); 
        box-shadow: 0 0 0 4px color-mix(in srgb, var(--primary-light) 30%, transparent);
    }
     /* Ensure theme toggle button gets specific styling if needed, though covered by general button */
    .theme-toggle-button:focus-visible {
        outline: 2px solid var(--text-on-primary); /* High contrast on header */
        outline-offset: 2px;
        box-shadow: 0 0 0 4px color-mix(in srgb, var(--text-on-primary) 30%, transparent);
    }
    html[data-theme="dark"] .theme-toggle-button:focus-visible {
        outline-color: var(--primary-light); /* High contrast on dark header */
         box-shadow: 0 0 0 4px color-mix(in srgb, var(--primary-light) 30%, transparent);
    }


    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 var(--spacing-md);
    }

    .section {
      padding: var(--spacing-xl) 0;
      margin-bottom: var(--spacing-lg);
      border-bottom: 1px solid var(--divider);
      transition: border-color var(--transition-standard);
    }

    .section:last-child {
      border-bottom: none;
    }

    .header {
      background: var(--header-gradient);
      color: var(--text-on-primary);
      padding: var(--spacing-xl) var(--spacing-md) var(--spacing-lg);
      position: relative;
      overflow: hidden;
      box-shadow: var(--header-shadow);
      border-bottom-left-radius: var(--radius-lg);
      border-bottom-right-radius: var(--radius-lg);
      z-index: 10;
      transition: background var(--transition-standard), box-shadow var(--transition-standard), color var(--transition-standard);
    }

    .header::after {
      content: '';
      position: absolute;
      bottom: -10px;
      left: 0;
      width: 100%;
      height: 20px;
      background: var(--surface); 
      border-radius: 50% 50% 0 0 / 100% 100% 0 0;
      transition: background-color var(--transition-standard);
    }
    html[data-theme="dark"] .header::after {
        background: var(--background); 
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      font-family: 'Playfair Display', serif;
      font-size: 1.75rem;
      font-weight: 700;
      color: var(--text-on-primary); 
      display: flex;
      align-items: center;
    }

    .logo .material-icons-round {
      margin-right: var(--spacing-xs);
    }

    .header-actions {
      display: flex;
      align-items: center;
    }
    
    .theme-toggle-button { /* Also applies to profile and favorites button in header */
      background: none;
      border: none;
      color: var(--text-on-primary);
      cursor: pointer;
      padding: var(--spacing-xs);
      border-radius: var(--radius-full);
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-left: var(--spacing-sm); 
    }
    #theme-toggle { margin-right: var(--spacing-xs); } /* Specific for theme toggle */

    .theme-toggle-button:hover {
      background-color: rgba(255,255,255,0.1);
    }
    .theme-toggle-button .material-icons-round {
      font-size: 1.5rem;
    }
    html[data-theme="dark"] .theme-toggle-button {
        color: var(--text-on-primary); 
    }
    html[data-theme="dark"] .theme-toggle-button:hover {
      background-color: rgba(0,0,0,0.1); 
    }

    /* .header-actions .material-icons-round no longer needed as buttons wrap icons */

    .notification-badge {
      position: relative;
      display: inline-flex;
      color: var(--text-on-primary);
      padding: var(--spacing-xs); /* To match other buttons if it were one */
      margin-left: var(--spacing-sm);
    }
    .notification-badge .material-icons-round { 
        font-size: 1.5rem;
    }

    .notification-badge .badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background-color: var(--error); 
      color: white;
      border-radius: 50%;
      width: 16px;
      height: 16px;
      font-size: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--spacing-lg);
      position: relative;
    }

    .section-header::before {
      content: '';
      position: absolute;
      left: 0;
      top: 50%;
      width: 3px;
      height: 70%;
      background-color: var(--accent);
      transform: translateY(-50%);
      transition: background-color var(--transition-standard);
    }

    .section-title {
      font-weight: 600;
      margin-bottom: 0;
      padding-left: var(--spacing-sm);
    }

    .section-action {
      color: var(--primary);
      font-size: 0.875rem;
      font-weight: 500;
      display: flex;
      align-items: center;
    }

    .section-action .material-icons-round {
      font-size: 1rem;
      margin-left: var(--spacing-xs);
    }

    .card-grid, .favorites-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: var(--spacing-lg);
    }

    .card-scroll {
      display: flex;
      overflow-x: auto;
      padding: var(--spacing-md) 0;
      scroll-snap-type: x mandatory;
      scrollbar-width: none; 
      -ms-overflow-style: none; 
      gap: var(--spacing-md);
    }

    .card-scroll::-webkit-scrollbar {
      display: none; 
    }

    .card {
      background-color: var(--surface-elevated);
      border-radius: var(--radius-md);
      overflow: hidden;
      box-shadow: var(--card-shadow);
      transition: var(--transition-standard); 
      scroll-snap-align: start;
      flex: 0 0 280px;
      position: relative; /* For favorite button positioning */
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: var(--card-hover-shadow);
    }

    .card-image {
      width: 100%;
      height: 160px;
      object-fit: cover;
      background-color: var(--divider); 
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
      transition: background-color var(--transition-standard);
    }

    .card-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }

    .card:hover .card-image img {
      transform: scale(1.05);
    }

    .card-image .placeholder-icon {
      color: var(--text-tertiary);
      font-size: 48px;
      opacity: 0.5;
      transition: color var(--transition-standard);
    }

    .card-content {
      padding: var(--spacing-md);
    }

    .card-title {
      font-size: 1.1rem;
      margin-bottom: var(--spacing-xs);
      font-weight: 600;
      color: var(--text-primary);
    }

    .card-description {
      font-size: 0.875rem;
      color: var(--text-tertiary); 
      margin-bottom: var(--spacing-sm);
    }

    .card-meta {
      display: flex;
      align-items: center;
      font-size: 0.75rem;
      color: var(--text-tertiary);
      transition: color var(--transition-standard);
    }

    .card-meta .material-icons-round {
      font-size: 0.875rem;
      margin-right: var(--spacing-xs);
    }

    /* Favorite Button on Card */
    .favorite-button {
        position: absolute;
        top: var(--spacing-sm);
        right: var(--spacing-sm);
        background-color: rgba(0,0,0,0.3);
        color: white;
        border: none;
        border-radius: var(--radius-full);
        width: 36px;
        height: 36px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        z-index: 1;
        transition: background-color var(--transition-fast), color var(--transition-fast), transform var(--transition-fast);
    }
    .favorite-button:hover {
        background-color: rgba(0,0,0,0.5);
        transform: scale(1.1);
    }
    .favorite-button .material-icons-round {
        font-size: 20px;
    }
    .favorite-button.favorited {
        background-color: var(--error); /* Or --accent */
        color: white;
    }
    /* Icon change for .favorited is handled by JS by changing textContent */


    .video-card {
      flex: 0 0 480px;
    }

    .video-container {
      position: relative;
      width: 100%;
      height: 0;
      padding-bottom: 56.25%; 
      overflow: hidden;
      border-radius: var(--radius-md) var(--radius-md) 0 0;
    }

    .video-container iframe {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: none;
    }

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background: var(--surface-elevated);
      display: flex;
      justify-content: space-around;
      align-items: center;
      height: 70px;
      box-shadow: var(--nav-shadow);
      z-index: 2001; 
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      transition: background-color var(--transition-standard), box-shadow var(--transition-standard);
    }

    .nav-item {
      color: var(--text-tertiary);
      text-decoration: none;
      font-size: 0.75rem;
      font-weight: 500;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: var(--spacing-xs);
      border-radius: var(--radius-sm); /* For focus indicator */
    }

    .nav-item .material-icons-round {
      font-size: 1.5rem;
      margin-bottom: var(--spacing-xs);
      transition: color var(--transition-fast); 
    }

    .nav-item.active {
      color: var(--primary);
    }
    .nav-item.active .material-icons-round {
      color: var(--primary); 
    }

    .nav-item:hover {
      color: var(--primary-light);
    }
    .nav-item:hover .material-icons-round {
      color: var(--primary-light); 
    }
    
    .bible-modal, .search-modal, .notes-modal, .sabbath-modal, .profile-modal, .favorites-modal {
      position: fixed;
      top: 0;
      bottom: 70px; 
      left: 0;
      right: 0;
      width: 100%;
      background-color: var(--surface);
      z-index: 2000;
      overflow: hidden; 
      box-shadow: var(--shadow-xl);
      display: flex;
      flex-direction: column;
      border-radius: 0; 
      opacity: 0;
      transform: translateY(30px); 
      pointer-events: none; 
      height: calc(100vh - 70px); 
      transition: opacity var(--transition-standard), transform var(--transition-standard) cubic-bezier(0.25, 0.8, 0.25, 1), 
                  background-color var(--transition-standard), color var(--transition-standard);
    }

    .bible-modal.open, .search-modal.open, .notes-modal.open, .sabbath-modal.open, .profile-modal.open, .favorites-modal.open {
      opacity: 1;
      transform: translateY(0); 
      pointer-events: auto;
    }

    .modal-header {
      background-color: var(--primary-dark);
      color: var(--text-on-primary);
      padding: var(--spacing-md);
      display: flex;
      justify-content: space-between;
      align-items: center;
      min-height: 60px;
      border-bottom: 1px solid var(--divider);
      transition: background-color var(--transition-standard), color var(--transition-standard), border-color var(--transition-standard);
    }
    .modal-title {
      font-weight: 600;
      margin-bottom: 0;
      font-size: 20px;
    }
    .modal-close {
      background: none;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--accent);
      transition: color var(--transition-fast);
      border-radius: var(--radius-full); /* For focus state consistency */
      padding: var(--spacing-xs); /* For focus state consistency */
    }
    html[data-theme="dark"] .modal-close {
      color: var(--accent); 
    }
    .modal-close:hover {
      color: var(--text-on-primary); 
    }
    html[data-theme="dark"] .modal-close:hover {
       color: color-mix(in srgb, var(--text-on-primary) 80%, var(--accent));
    }

    .modal-content {
      flex: 1;
      overflow-y: auto;
    }
    .search-modal .modal-content { padding: var(--spacing-md); }
    .favorites-modal .modal-content { padding: var(--spacing-md); } 
    .notes-modal .modal-content { display: flex; overflow: hidden; padding: 0; }
    .sabbath-modal .modal-content { display: flex; overflow: hidden; padding: 0; }
    .bible-modal .modal-content {
        overflow: hidden; 
        position: relative; 
        padding: 0; 
    }

    .bible-iframe-container {
      width: 100%;
      height: 100%;
      position: relative;
    }
    
    .bible-iframe {
      width: 100%;
      height: 100%;
      border: none;
    }
    
    .version-button {
      background-color: var(--accent);
      color: var(--primary-dark); 
      border: none;
      border-radius: var(--radius-full);
      padding: var(--spacing-xs) var(--spacing-md);
      font-size: 0.875rem;
      font-weight: 500;
      display: flex;
      align-items: center;
      position: absolute;
      top: 12px;
      right: 70px; 
      z-index: 5;
      transition: background-color var(--transition-standard), color var(--transition-standard);
    }
    html[data-theme="dark"] .version-button {
        background-color: var(--accent); 
        color: var(--primary); 
    }
    
    .version-button:hover {
      background-color: var(--accent-dark); 
    }
    html[data-theme="dark"] .version-button:hover {
        background-color: var(--accent-dark); 
    }
    
    .version-button .material-icons-round {
      font-size: 1rem;
      margin-left: var(--spacing-xs);
    }
    
    .version-selector {
      position: absolute;
      top: 60px;
      right: var(--spacing-md);
      width: 320px;
      max-width: 90vw;
      background-color: var(--surface-elevated);
      border-radius: var(--radius-md);
      box-shadow: var(--shadow-xl);
      z-index: 2100;
      display: none;
      overflow: hidden;
      transition: background-color var(--transition-standard), box-shadow var(--transition-standard);
    }
    
    .version-selector.open {
      display: block;
    }
    
    .version-tabs {
      display: flex;
      border-bottom: 1px solid var(--divider);
      transition: border-color var(--transition-standard);
    }
    
    .version-tab {
      flex: 1;
      padding: var(--spacing-sm) var(--spacing-md);
      text-align: center;
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--text-tertiary);
      background: none;
      border: none;
      cursor: pointer;
      transition: color var(--transition-standard), border-color var(--transition-standard);
      border-radius: var(--radius-sm) var(--radius-sm) 0 0; /* For focus */
    }
    
    .version-tab.active {
      color: var(--primary);
      border-bottom: 2px solid var(--primary);
    }
    
    .version-search {
      padding: var(--spacing-sm);
      border-bottom: 1px solid var(--divider);
      transition: border-color var(--transition-standard);
    }
    
    .version-search input {
      width: 100%;
      padding: var(--spacing-sm) var(--spacing-md);
      font-size: 0.875rem;
    }
    
    .version-list {
      max-height: 300px;
      overflow-y: auto;
      padding: var(--spacing-sm) 0;
    }
    
    .version-item {
      display: flex;
      align-items: center;
      padding: var(--spacing-sm) var(--spacing-md);
      border: none;
      background: none;
      width: 100%;
      text-align: left;
      cursor: pointer;
      transition: var(--transition-fast);
      color: var(--text-primary); 
      border-radius: 0; /* For focus unless specific needed */
    }
    
    .version-item:hover {
      background-color: var(--surface-variant);
    }
    
    .version-item.preferred {
      color: var(--primary);
      font-weight: 500;
    }
    
    .version-item .version-abbr {
      font-weight: 600;
      margin-right: var(--spacing-sm);
      min-width: 50px;
    }
    
    .version-item .version-name {
      flex: 1;
      font-size: 0.875rem;
    }
    
    .guidance-message {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: rgba(0, 0, 0, 0.7); 
      color: white;
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--radius-full);
      font-size: 0.875rem;
      opacity: 0;
      transition: opacity 0.5s ease;
      pointer-events: none;
      text-align: center;
      max-width: 80%;
    }
    
    .search-input-container {
      position: relative;
      margin-bottom: var(--spacing-lg);
    }
    
    .search-input {
      width: 100%;
      padding: var(--spacing-md) var(--spacing-md) var(--spacing-md) 50px;
      border-radius: var(--radius-full);
      font-size: 1rem;
      box-shadow: var(--shadow-sm);
      transition: var(--transition-standard); 
    }
    
    .search-input:focus-visible { 
      outline: none;
      border-color: var(--primary);
      box-shadow: var(--shadow-md), 0 0 0 2px color-mix(in srgb, var(--primary) 30%, transparent); 
    }
    
    .search-icon {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-tertiary);
      transition: color var(--transition-standard);
    }
    
    .search-results-info {
      margin-bottom: var(--spacing-md);
      color: var(--text-secondary);
      font-size: 0.875rem;
      transition: color var(--transition-standard);
    }
    
    .search-results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: var(--spacing-lg);
    }
    
    .search-empty-state, .notes-empty-state, .sabbath-empty-state, .favorites-empty-state {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: var(--spacing-xxl) 0;
      color: var(--text-tertiary);
      text-align: center;
      transition: color var(--transition-standard);
      width: 100%; /* Ensure it takes full width in its container */
      height: 100%; /* Ensure it takes full height if parent allows */
    }
    
    .search-empty-state .material-icons-round,
    .notes-empty-state .material-icons-round,
    .sabbath-empty-state .material-icons-round,
    .favorites-empty-state .material-icons-round {
      font-size: 4rem; /* Default size, overridden by inline style for enhanced */
      margin-bottom: var(--spacing-md);
      opacity: 0.5; /* Default opacity, overridden by inline style for enhanced */
    }
    
    .search-empty-title, .notes-empty-title, .sabbath-empty-title, .favorites-empty-title {
      font-size: 1.25rem;
      margin-bottom: var(--spacing-sm);
      color: var(--text-primary);
      transition: color var(--transition-standard);
    }
    
    .search-empty-message, .notes-empty-message, .sabbath-empty-message, .favorites-empty-message {
      font-size: 0.875rem;
      max-width: 400px;
      margin: 0 auto;
    }
    
    /* Notes Sidebar & Tagging Styles */
    .notes-sidebar, .sabbath-sidebar {
      width: 300px;
      border-right: 1px solid var(--divider);
      overflow-y: auto;
      background-color: var(--surface); 
      transition: border-color var(--transition-standard), background-color var(--transition-standard);
      display: flex;
      flex-direction: column;
    }
    
    .notes-controls { /* Container for search and tags filter */
      padding: var(--spacing-md);
      border-bottom: 1px solid var(--divider);
      transition: border-color var(--transition-standard);
    }
    .notes-search-input { 
        width: 100%;
        font-size: 0.875rem;
        padding: var(--spacing-sm) var(--spacing-md); 
        margin-bottom: var(--spacing-sm); /* Space before tag filter */
    } 
    .sabbath-quarters {
      padding: var(--spacing-md);
      border-bottom: 1px solid var(--divider);
      transition: border-color var(--transition-standard);
    }
    .sabbath-quarter-select { width: 100%; font-size: 0.875rem; }

    #allTagsArea {
        margin-top: var(--spacing-sm);
    }
    #allTagsArea h6 {
        font-size: 0.8rem;
        color: var(--text-tertiary);
        margin-bottom: var(--spacing-xs);
        font-family: 'Poppins', sans-serif; /* Match body font */
        font-weight: 500;
    }
    #tagPillsContainer {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-xs);
        margin-bottom: var(--spacing-xs);
    }
    .tag-pill {
        background-color: var(--surface-variant);
        color: var(--text-secondary);
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: var(--radius-full);
        font-size: 0.75rem;
        cursor: pointer;
        border: 1px solid transparent;
        transition: var(--transition-fast);
        display: inline-flex; 
        align-items: center; 
    }
    .tag-pill:hover {
        background-color: var(--divider);
        color: var(--text-primary);
    }
    .tag-pill.active-filter {
        background-color: var(--primary);
        color: var(--text-on-primary);
        border-color: var(--primary-dark);
    }
    .tag-pill .remove-tag-icon { /* For tags in editor */
        font-size: 1rem;
        margin-left: var(--spacing-xs);
        opacity: 0.7;
        line-height: 1; /* Ensure icon is vertically centered */
    }
    .tag-pill:hover .remove-tag-icon {
        opacity: 1;
    }

    #clearTagFilterBtn {
        font-size: 0.75rem;
        color: var(--primary);
        background: none;
        border: none;
        padding: var(--spacing-xs) 0;
        cursor: pointer;
        display: none; /* Hidden by default */
        margin-top: var(--spacing-xs);
    }
    #clearTagFilterBtn:hover {
        color: var(--primary-light);
    }
    
    .notes-list, .sabbath-lessons {
      padding: var(--spacing-sm) 0;
      flex-grow: 1; /* Allow list to take remaining space */
      overflow-y: auto; /* Ensure list itself is scrollable if content overflows */
    }
    
    .note-item, .sabbath-lesson {
      padding: var(--spacing-md);
      border-bottom: 1px solid var(--divider);
      cursor: pointer;
      transition: var(--transition-fast); 
      border-radius: 0; 
    }
    
    .note-item:hover, .sabbath-lesson:hover {
      background-color: var(--surface-variant);
    }
    
    .note-item.active, .sabbath-lesson.active {
      background-color: color-mix(in srgb, var(--primary) 10%, transparent); 
      border-left: 3px solid var(--primary);
      padding-left: calc(var(--spacing-md) - 3px); /* Adjust padding for border */
    }
    
    .note-title, .sabbath-lesson-title {
      font-weight: 600;
      font-size: 0.9rem;
      margin-bottom: var(--spacing-xs);
      color: var(--text-primary);
      transition: color var(--transition-standard);
    }
    
    .note-preview, .note-date, .sabbath-lesson-date {
      font-size: 0.8rem;
      color: var(--text-tertiary);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      transition: color var(--transition-standard);
    }
    .note-date { font-size: 0.7rem; margin-top: var(--spacing-xs); }
    .note-tags-preview { /* For tags on note item */
        font-size: 0.7rem;
        color: var(--text-tertiary);
        margin-top: var(--spacing-xs);
        opacity: 0.8;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    
    .notes-content, .sabbath-content { 
      flex: 1;
      padding: var(--spacing-lg);
      overflow-y: auto;
      background-color: var(--background); 
      transition: background-color var(--transition-standard);
    }
    
    .note-editor {
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    .note-editor-title { 
      font-size: 1.5rem;
      font-weight: 600;
      padding: var(--spacing-sm) 0;
      margin-bottom: var(--spacing-sm); /* Reduced margin */
      border: none;
      border-bottom: 1px solid var(--divider);
      width: 100%;
    }
    
    .note-editor-title:focus-visible { 
      outline: none;
      border-bottom-color: var(--primary);
    }

    /* Tag input in editor */
    #noteTagInputContainer {
        margin-bottom: var(--spacing-md);
    }
    #noteTagInput {
        width: 100%;
        padding: var(--spacing-sm);
        font-size: 0.875rem;
        margin-bottom: var(--spacing-xs);
    }
    #currentNoteTags {
        display: flex;
        flex-wrap: wrap;
        gap: var(--spacing-xs);
    }
    
    .note-editor-body { 
      flex: 1;
      padding: var(--spacing-sm) 0;
      border: none;
      resize: none;
      font-size: 1rem;
      line-height: 1.8;
      background-color: transparent; 
      width: 100%;
    }
    
    .note-editor-body:focus-visible { 
      outline: none;
    }
        
    .sabbath-day {
      margin-bottom: var(--spacing-xl);
    }
    
    .sabbath-day-title {
      font-size: 1.25rem;
      margin-bottom: var(--spacing-md);
      padding-bottom: var(--spacing-xs);
      border-bottom: 1px solid var(--divider);
      transition: border-color var(--transition-standard);
    }
    
    .sabbath-day-content {
      font-size: 1rem;
      line-height: 1.8;
    }
    
    .sabbath-day-content p {
      margin-bottom: var(--spacing-md);
    }
    
    .sabbath-day-content h4 {
      margin-top: var(--spacing-lg);
      margin-bottom: var(--spacing-sm);
      font-size: 1.1rem;
    }
    
    .sabbath-day-content blockquote {
      border-left: 3px solid var(--primary);
      padding-left: var(--spacing-md);
      margin: var(--spacing-md) 0;
      font-style: italic;
      color: var(--text-secondary);
      transition: border-color var(--transition-standard), color var(--transition-standard);
    }

    /* Skeleton Loader Styles */
    .skeleton {
      background-color: var(--surface-variant);
      border-radius: var(--radius-sm);
      position: relative;
      overflow: hidden; 
    }

    .skeleton::before { 
      content: '';
      position: absolute;
      top: 0;
      left: -150%; 
      height: 100%;
      width: 150%;
      background: linear-gradient(to right, transparent 0%, color-mix(in srgb, var(--surface-elevated) 50%, transparent) 50%, transparent 100%);
      animation: shimmer 1.5s infinite linear;
    }

    @keyframes shimmer {
      0% { transform: translateX(0); }
      100% { transform: translateX(100%); } 
    }

    .skeleton-loader-grid { 
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: var(--spacing-lg);
    }
    .skeleton-card {
        background-color: var(--surface-elevated); 
        padding: var(--spacing-md); 
         border-radius: var(--radius-md); 
    }
    .skeleton-image { width: 100%; height: 160px; margin-bottom: var(--spacing-md); }
    .skeleton-content { display: flex; flex-direction: column; gap: var(--spacing-sm); padding-top: var(--spacing-xs); }
    .skeleton-title { width: 70%; height: 20px; }
    .skeleton-text { width: 100%; height: 14px; }
    .skeleton-text-short { width: 80%; height: 14px; }
    .skeleton-meta { width: 40%; height: 12px; margin-top: var(--spacing-xs); }

    .skeleton-loader-list { 
        display: flex;
        flex-direction: column;
        gap: var(--spacing-xs); 
    }
    .skeleton-note-item {
        padding: var(--spacing-md);
        border-bottom: 1px solid var(--divider); 
        background-color: var(--surface); 
    }
    .skeleton-note-title { width: 60%; height: 18px; margin-bottom: var(--spacing-xs); }
    .skeleton-note-preview { width: 90%; height: 14px; margin-bottom: var(--spacing-xs); }
    .skeleton-note-date { width: 40%; height: 12px; }

    /* Enhanced Empty State Button */
    .button-primary {
        background-color: var(--primary);
        color: var(--text-on-primary);
        border: none;
        padding: var(--spacing-sm) var(--spacing-lg);
        border-radius: var(--radius-sm);
        font-weight: 500;
        font-size: 0.9rem;
        cursor: pointer;
    }
    .button-primary:hover {
        background-color: var(--primary-light);
    }
    html[data-theme="dark"] .button-primary {
        background-color: var(--primary);
        color: var(--text-on-primary); 
    }
    html[data-theme="dark"] .button-primary:hover {
        background-color: var(--primary-light);
    }
    
    /* Scroll-to-Top Button */
    #scrollToTopBtn {
      position: fixed;
      bottom: 90px; /* Above bottom nav */
      right: var(--spacing-md);
      background-color: var(--primary);
      color: var(--text-on-primary);
      border: none;
      border-radius: var(--radius-full);
      width: 50px;
      height: 50px;
      box-shadow: var(--shadow-lg);
      cursor: pointer;
      display: none; 
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      transform: translateY(20px);
      transition: opacity var(--transition-standard), transform var(--transition-standard), background-color var(--transition-standard);
    }
    #scrollToTopBtn.show {
      display: flex; 
      opacity: 1;
      transform: translateY(0);
    }
    #scrollToTopBtn:hover {
      background-color: var(--primary-light);
    }
    #scrollToTopBtn .material-icons-round {
      font-size: 24px; 
    }
    html[data-theme="dark"] #scrollToTopBtn {
        background-color: var(--primary);
        color: var(--text-on-primary);
    }
    html[data-theme="dark"] #scrollToTopBtn:hover {
        background-color: var(--primary-light);
    }
        
    /* Responsive Adjustments */
    @media (max-width: 768px) {
      .section-header { flex-direction: column; align-items: flex-start; }
      .section-action { margin-top: var(--spacing-xs); margin-left: var(--spacing-sm); }
      .card-grid, .skeleton-loader-grid, .favorites-grid { grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); }
      .notes-sidebar, .sabbath-sidebar { width: 250px; }
      .video-card { flex: 0 0 100%; }
    }
    
    @media (max-width: 640px) {
      .notes-modal .modal-content, 
      .sabbath-modal .modal-content { 
          flex-direction: column; 
      }
      .notes-sidebar, .sabbath-sidebar {
        width: 100%;
        height: auto; /* Adjust height for content */
        max-height: 45vh; /* Increase max-height or make it flexible */
        border-right: none;
        border-bottom: 1px solid var(--divider);
      }
      .notes-list { /* Ensure notes list inside sidebar is scrollable on mobile */
         max-height: calc(45vh - 120px); /* approx height of controls */
      }
    }
    
    @media (max-width: 480px) {
      .card-grid, .skeleton-loader-grid, .favorites-grid { grid-template-columns: 1fr; }
      .header-content { flex-direction: column; align-items: flex-start; }
      .header-actions { margin-top: var(--spacing-sm); }
    }

    /* Scrollbar styling */
    .version-list::-webkit-scrollbar,
    .notes-sidebar::-webkit-scrollbar,
    .sabbath-sidebar::-webkit-scrollbar,
    .notes-content::-webkit-scrollbar,
    .sabbath-content::-webkit-scrollbar,
    .search-modal .modal-content::-webkit-scrollbar, 
    .profile-modal .modal-content::-webkit-scrollbar,
    .bible-modal .modal-content::-webkit-scrollbar,
    .favorites-modal .modal-content::-webkit-scrollbar,
    .notes-list::-webkit-scrollbar { /* Added notes-list for its own scrollbar */
        width: 8px;
    }
    .version-list::-webkit-scrollbar-track,
    .notes-sidebar::-webkit-scrollbar-track,
    .sabbath-sidebar::-webkit-scrollbar-track,
    .notes-content::-webkit-scrollbar-track,
    .sabbath-content::-webkit-scrollbar-track,
    .search-modal .modal-content::-webkit-scrollbar-track, 
    .profile-modal .modal-content::-webkit-scrollbar-track,
    .bible-modal .modal-content::-webkit-scrollbar-track,
    .favorites-modal .modal-content::-webkit-scrollbar-track,
    .notes-list::-webkit-scrollbar-track {
        background: var(--surface-variant);
    }
    .version-list::-webkit-scrollbar-thumb,
    .notes-sidebar::-webkit-scrollbar-thumb,
    .sabbath-sidebar::-webkit-scrollbar-thumb,
    .notes-content::-webkit-scrollbar-thumb,
    .sabbath-content::-webkit-scrollbar-thumb,
    .search-modal .modal-content::-webkit-scrollbar-thumb, 
    .profile-modal .modal-content::-webkit-scrollbar-thumb,
    .bible-modal .modal-content::-webkit-scrollbar-thumb,
    .favorites-modal .modal-content::-webkit-scrollbar-thumb,
    .notes-list::-webkit-scrollbar-thumb {
        background-color: var(--divider);
        border-radius: var(--radius-sm);
        border: 2px solid var(--surface-variant);
    }
    .version-list,
    .notes-sidebar,
    .sabbath-sidebar,
    .notes-content,
    .sabbath-content,
    .search-modal .modal-content, 
    .profile-modal .modal-content,
    .bible-modal .modal-content,
    .favorites-modal .modal-content,
    .notes-list {
        scrollbar-width: thin;
        scrollbar-color: var(--divider) var(--surface-variant); 
    }

    /* Scrollbar styling for dark mode */
    html[data-theme="dark"] .version-list::-webkit-scrollbar-track,
    html[data-theme="dark"] .notes-sidebar::-webkit-scrollbar-track,
    html[data-theme="dark"] .sabbath-sidebar::-webkit-scrollbar-track,
    html[data-theme="dark"] .notes-content::-webkit-scrollbar-track,
    html[data-theme="dark"] .sabbath-content::-webkit-scrollbar-track,
    html[data-theme="dark"] .search-modal .modal-content::-webkit-scrollbar-track, 
    html[data-theme="dark"] .profile-modal .modal-content::-webkit-scrollbar-track,
    html[data-theme="dark"] .bible-modal .modal-content::-webkit-scrollbar-track,
    html[data-theme="dark"] .favorites-modal .modal-content::-webkit-scrollbar-track,
    html[data-theme="dark"] .notes-list::-webkit-scrollbar-track { 
        background: var(--surface);
    }
    html[data-theme="dark"] .version-list::-webkit-scrollbar-thumb,
    html[data-theme="dark"] .notes-sidebar::-webkit-scrollbar-thumb,
    html[data-theme="dark"] .sabbath-sidebar::-webkit-scrollbar-thumb,
    html[data-theme="dark"] .notes-content::-webkit-scrollbar-thumb,
    html[data-theme="dark"] .sabbath-content::-webkit-scrollbar-thumb,
    html[data-theme="dark"] .search-modal .modal-content::-webkit-scrollbar-thumb, 
    html[data-theme="dark"] .profile-modal .modal-content::-webkit-scrollbar-thumb,
    html[data-theme="dark"] .bible-modal .modal-content::-webkit-scrollbar-thumb,
    html[data-theme="dark"] .favorites-modal .modal-content::-webkit-scrollbar-thumb,
    html[data-theme="dark"] .notes-list::-webkit-scrollbar-thumb { 
        background-color: var(--divider);
        border: 2px solid var(--surface);
    }
    html[data-theme="dark"] .version-list,
    html[data-theme="dark"] .notes-sidebar,
    html[data-theme="dark"] .sabbath-sidebar,
    html[data-theme="dark"] .notes-content,
    html[data-theme="dark"] .sabbath-content,
    html[data-theme="dark"] .search-modal .modal-content, 
    html[data-theme="dark"] .profile-modal .modal-content,
    html[data-theme="dark"] .bible-modal .modal-content,
    html[data-theme="dark"] .favorites-modal .modal-content,
    html[data-theme="dark"] .notes-list { 
        scrollbar-color: var(--divider) var(--surface); 
    }

  </style>
</head>
<body>
  <!-- Loading Screen HTML -->
  <div id="loading-screen">
    <div class="loader"></div>
    <p>Loading The Well...</p> 
  </div>

  <header class="header">
    <div class="container">
      <div class="header-content">
        <div class="logo">
          <span class="material-icons-round">eco</span>
          The Well
        </div>
        <div class="header-actions">
          <button id="theme-toggle" class="theme-toggle-button" aria-label="Switch to dark mode" aria-pressed="false">
            <span class="material-icons-round">light_mode</span> 
          </button>
          <button id="favorites-header-button" class="theme-toggle-button" aria-label="View Favorites">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="notification-badge">
            <span class="material-icons-round">notifications</span>
            <span class="badge">3</span>
          </div>
          <button id="profile-button" class="theme-toggle-button" aria-label="View Profile">
            <span class="material-icons-round">account_circle</span>
          </button>
        </div>
      </div>
    </div>
  </header>
  
  <main class="container">
    <!-- Start Here Section -->
    <section class="section">
      <div class="section-header">
        <h3 class="section-title">Start Here</h3>
        <a href="#" class="section-action">
          View All
          <span class="material-icons-round">arrow_forward</span>
        </a>
      </div>
      
      <div class="card-scroll">
        <div class="card" data-card-id="Who Is Jesus?">
          <button class="favorite-button" aria-label="Add Who Is Jesus? to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1504052434569-70ad5836ab65?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Understanding the Bible" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>menu_book</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Who Is Jesus?</h5>
            <p class="card-description">A comprehensive guide to biblical interpretation and study of who Jesus is.</p>
            <div class="card-meta">
              <span class="material-icons-round">access_time</span>
              8 lessons
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="The Holy Spirit">
          <button class="favorite-button" aria-label="Add The Holy Spirit to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1490730141103-6cac27aaab94?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="The Holy Spirit" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>local_fire_department</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">The Holy Spirit</h5>
            <p class="card-description">Explore the person and work of the Holy Spirit in the life of believers.</p>
            <div class="card-meta">
              <span class="material-icons-round">access_time</span>
              6 lessons
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Resurrection Power">
          <button class="favorite-button" aria-label="Add Resurrection Power to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1501612780327-45045538702b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Resurrection Power" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>brightness_7</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Resurrection Power</h5>
            <p class="card-description">Understanding the significance and power of Christ's resurrection.</p>
            <div class="card-meta">
              <span class="material-icons-round">access_time</span>
              5 lessons
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Prayer Fundamentals">
          <button class="favorite-button" aria-label="Add Prayer Fundamentals to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1476820865390-c52aeebb9891?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Prayer Fundamentals" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>volunteer_activism</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Prayer Fundamentals</h5>
            <p class="card-description">Learn the basics of effective prayer and developing a prayer life.</p>
            <div class="card-meta">
              <span class="material-icons-round">access_time</span>
              7 lessons
            </div>
          </div>
        </div>
      </div>
    </section>  
    
      <!-- Classes Section -->
    <section class="section">
      <div class="section-header">
        <h3 class="section-title">Classes</h3>
        <a href="#" class="section-action">
          View All
          <span class="material-icons-round">arrow_forward</span>
        </a>
      </div>
      
      <div class="card-scroll">
        <div class="card" data-card-id="Tots Class">
          <button class="favorite-button" aria-label="Add Tots Class to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1472162072942-cd5147eb3902?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Tots" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>school</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Tots</h5>
            <p class="card-description">Fun, interactive Bible lessons for young children.</p>
            <div class="card-meta">
              <span class="material-icons-round">people</span>
              Ages 3-4
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Class 1">
           <button class="favorite-button" aria-label="Add Class 1 to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1503676260728-1c00da094a0b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Class 1" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>school</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Class 1</h5>
            <p class="card-description">Foundational Bible stories and character lessons for children.</p>
            <div class="card-meta">
              <span class="material-icons-round">people</span>
              Ages 5-7
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Class 2">
           <button class="favorite-button" aria-label="Add Class 2 to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1511949860663-92c5c57d48a7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Class 2" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>school</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Class 2</h5>
            <p class="card-description">Bible exploration and application for elementary-aged children.</p>
            <div class="card-meta">
              <span class="material-icons-round">people</span>
              Ages 8-11
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Class 3">
           <button class="favorite-button" aria-label="Add Class 3 to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1509062522246-3755977927d7?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Class 3" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>school</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Class 3</h5>
            <p class="card-description">Deeper biblical study and discipleship for pre-teens and teens.</p>
            <div class="card-meta">
              <span class="material-icons-round">people</span>
              Ages 12-16
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Class 4">
           <button class="favorite-button" aria-label="Add Class 4 to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1523240795612-9a054b0db644?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Class 4" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>school</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Class 4</h5>
            <p class="card-description">Faith formation and life application for young adults.</p>
            <div class="card-meta">
              <span class="material-icons-round">people</span>
              Ages 17-22
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Class 5">
           <button class="favorite-button" aria-label="Add Class 5 to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1529070538774-1843cb3265df?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Class 5" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>school</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Class 5</h5>
            <p class="card-description">Advanced biblical teaching and spiritual growth for adults.</p>
            <div class="card-meta">
              <span class="material-icons-round">people</span>
              Ages 23 and up
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Recent Additions Section -->
    <section class="section">
      <div class="section-header">
        <h3 class="section-title">Recent Additions</h3>
        <a href="#" class="section-action">
          View All
          <span class="material-icons-round">arrow_forward</span>
        </a>
      </div>
      
      <div class="card-scroll">
        <div class="card" data-card-id="Understanding the Bible">
           <button class="favorite-button" aria-label="Add Understanding the Bible to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1504052434569-70ad5836ab65?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Understanding the Bible" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>menu_book</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Understanding the Bible</h5>
            <p class="card-description">A comprehensive guide to biblical interpretation and study methods.</p>
            <div class="card-meta">
              <span class="material-icons-round">access_time</span>
              8 lessons
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="The Holy Spirit Recent"> 
           <button class="favorite-button" aria-label="Add The Holy Spirit Recent to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1490730141103-6cac27aaab94?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="The Holy Spirit" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>local_fire_department</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">The Holy Spirit</h5>
            <p class="card-description">Explore the person and work of the Holy Spirit in the life of believers.</p>
            <div class="card-meta">
              <span class="material-icons-round">access_time</span>
              6 lessons
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Resurrection Power Recent">
           <button class="favorite-button" aria-label="Add Resurrection Power Recent to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1501612780327-45045538702b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Resurrection Power" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>brightness_7</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Resurrection Power</h5>
            <p class="card-description">Understanding the significance and power of Christ's resurrection.</p>
            <div class="card-meta">
              <span class="material-icons-round">access_time</span>
              5 lessons
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Prayer Fundamentals Recent">
           <button class="favorite-button" aria-label="Add Prayer Fundamentals Recent to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1476820865390-c52aeebb9891?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Prayer Fundamentals" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>volunteer_activism</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Prayer Fundamentals</h5>
            <p class="card-description">Learn the basics of effective prayer and developing a prayer life.</p>
            <div class="card-meta">
              <span class="material-icons-round">access_time</span>
              7 lessons
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- Popular Courses Section -->
    <section class="section">
      <div class="section-header">
        <h3 class="section-title">Popular Courses</h3>
        <a href="#" class="section-action">
          View All
          <span class="material-icons-round">arrow_forward</span>
        </a>
      </div>
      
      <div class="card-scroll">
        <div class="card" data-card-id="Foundations of Faith">
           <button class="favorite-button" aria-label="Add Foundations of Faith to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1507525428034-b723cf961d3e?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Foundations of Faith" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>foundation</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Foundations of Faith</h5>
            <p class="card-description">Essential teachings for new believers and those seeking to strengthen their faith.</p>
            <div class="card-meta">
              <span class="material-icons-round">people</span>
              2,456 enrolled
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Spiritual Disciplines">
           <button class="favorite-button" aria-label="Add Spiritual Disciplines to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1504052434569-70ad5836ab65?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Spiritual Disciplines" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>self_improvement</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Spiritual Disciplines</h5>
            <p class="card-description">Practices that promote spiritual growth and a deeper relationship with God.</p>
            <div class="card-meta">
              <span class="material-icons-round">people</span>
              1,892 enrolled
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Biblical Leadership">
           <button class="favorite-button" aria-label="Add Biblical Leadership to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1455849318743-b2233052fcff?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Biblical Leadership" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>groups</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Biblical Leadership</h5>
            <p class="card-description">Principles and practices of effective leadership based on biblical examples.</p>
            <div class="card-meta">
              <span class="material-icons-round">people</span>
              1,345 enrolled
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Gospel Foundations">
           <button class="favorite-button" aria-label="Add Gospel Foundations to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1504052434569-70ad5836ab65?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Gospel Foundations" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>favorite</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Gospel Foundations</h5>
            <p class="card-description">Understanding the core message of the gospel and its implications for life.</p>
            <div class="card-meta">
              <span class="material-icons-round">people</span>
              1,129 enrolled
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- Topics Section -->
    <section class="section">
      <div class="section-header">
        <h3 class="section-title">Topics</h3>
        <a href="#" class="section-action">
          View All
          <span class="material-icons-round">arrow_forward</span>
        </a>
      </div>
      
      <div class="card-scroll">
        <div class="card" data-card-id="Biblical Studies Topic">
          <button class="favorite-button" aria-label="Add Biblical Studies Topic to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1504052434569-70ad5836ab65?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Biblical Studies" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>menu_book</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Biblical Studies</h5>
            <p class="card-description">In-depth exploration of biblical books, themes, and interpretation.</p>
            <div class="card-meta">
              <span class="material-icons-round">folder</span>
              25 courses
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Christian Life Topic">
           <button class="favorite-button" aria-label="Add Christian Life Topic to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1490730141103-6cac27aaab94?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Christian Life" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>person</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Christian Life</h5>
            <p class="card-description">Practical guidance for living out faith in everyday situations.</p>
            <div class="card-meta">
              <span class="material-icons-round">folder</span>
              18 courses
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Church Topic">
           <button class="favorite-button" aria-label="Add Church Topic to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1438032005730-c779502df39b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Church" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>church</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Church</h5>
            <p class="card-description">Understanding the nature, purpose, and practices of the church.</p>
            <div class="card-meta">
              <span class="material-icons-round">folder</span>
              15 courses
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Family Topic">
           <button class="favorite-button" aria-label="Add Family Topic to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1511895426328-dc8714191300?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Family" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>family_restroom</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Family</h5>
            <p class="card-description">Biblical principles for marriage, parenting, and family relationships.</p>
            <div class="card-meta">
              <span class="material-icons-round">folder</span>
              12 courses
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Theology Topic">
           <button class="favorite-button" aria-label="Add Theology Topic to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1501612780327-45045538702b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Theology" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>school</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Theology</h5>
            <p class="card-description">Systematic study of God and religious beliefs and practices.</p>
            <div class="card-meta">
              <span class="material-icons-round">folder</span>
              20 courses
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Spiritual Growth Topic">
           <button class="favorite-button" aria-label="Add Spiritual Growth Topic to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1490730141103-6cac27aaab94?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Spiritual Growth" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>trending_up</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Spiritual Growth</h5>
            <p class="card-description">Resources for developing spiritual maturity and Christ-like character.</p>
            <div class="card-meta">
              <span class="material-icons-round">folder</span>
              16 courses
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Ministry Topic">
           <button class="favorite-button" aria-label="Add Ministry Topic to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1476820865390-c52aeebb9891?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Ministry" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>volunteer_activism</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Ministry</h5>
            <p class="card-description">Training and resources for various areas of Christian service.</p>
            <div class="card-meta">
              <span class="material-icons-round">folder</span>
              14 courses
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Apologetics Topic">
           <button class="favorite-button" aria-label="Add Apologetics Topic to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1507842217343-583bb7270b66?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Apologetics" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>psychology</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Apologetics</h5>
            <p class="card-description">Reasoned arguments and evidence for the truth of Christianity.</p>
            <div class="card-meta">
              <span class="material-icons-round">folder</span>
              10 courses
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- Sermon/Lesson Series Section -->
    <section class="section">
      <div class="section-header">
        <h3 class="section-title">Sermon/Lesson Series</h3>
        <a href="#" class="section-action">
          View All
          <span class="material-icons-round">arrow_forward</span>
        </a>
      </div>
      
      <div class="card-scroll">
        <div class="card video-card" data-card-id="Sermon Series Playlist">
          <button class="favorite-button" aria-label="Add Sermon Series Playlist to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="video-container">
            <iframe src="https://www.youtube.com/embed/iRvHy_MqihI?list=PL8TR2V6jBVJ3wihHuBIlpbIz2CGiSe_Uq" title="Sermon Series" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
          </div>
          <div class="card-content">
            <h5 class="card-title">Sermon Series Playlist</h5>
            <p class="card-description">Watch our complete sermon series with powerful biblical teachings.</p>
            <div class="card-meta">
              <span class="material-icons-round">video_library</span>
              Full Playlist
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="The Beatitudes Series">
          <button class="favorite-button" aria-label="Add The Beatitudes Series to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1504052434569-70ad5836ab65?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="The Beatitudes" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>format_list_numbered</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">The Beatitudes</h5>
            <p class="card-description">Exploring Jesus' teachings on true happiness and kingdom living.</p>
            <div class="card-meta">
              <span class="material-icons-round">video_library</span>
              8 episodes
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Fruit of the Spirit Series">
          <button class="favorite-button" aria-label="Add Fruit of the Spirit Series to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1490730141103-6cac27aaab94?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Fruit of the Spirit" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>eco</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Fruit of the Spirit</h5>
            <p class="card-description">Understanding and cultivating the character qualities produced by the Holy Spirit.</p>
            <div class="card-meta">
              <span class="material-icons-round">video_library</span>
              9 episodes
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Heroes of Faith Series">
          <button class="favorite-button" aria-label="Add Heroes of Faith Series to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1501612780327-45045538702b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Heroes of Faith" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>military_tech</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Heroes of Faith</h5>
            <p class="card-description">Lessons from the lives of biblical characters who demonstrated extraordinary faith.</p>
            <div class="card-meta">
              <span class="material-icons-round">video_library</span>
              12 episodes
            </div>
          </div>
        </div>
      </div>
    </section>
    
    <!-- Apostle Steven Best Devotionals Section -->
    <section class="section">
      <div class="section-header">
        <h3 class="section-title">Apostle Steven Best Devotionals</h3>
        <a href="#" class="section-action">
          View All
          <span class="material-icons-round">arrow_forward</span>
        </a>
      </div>
      
      <div class="card-scroll">
        <div class="card" data-card-id="Daily Bread Devotional">
          <button class="favorite-button" aria-label="Add Daily Bread Devotional to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1504052434569-70ad5836ab65?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Daily Bread" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>breakfast_dining</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Daily Bread</h5>
            <p class="card-description">Short, daily reflections on Scripture for spiritual nourishment.</p>
            <div class="card-meta">
              <span class="material-icons-round">auto_stories</span>
              30 devotionals
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Quiet Moments Devotional">
          <button class="favorite-button" aria-label="Add Quiet Moments Devotional to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1490730141103-6cac27aaab94?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Quiet Moments" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>nightlight</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Quiet Moments</h5>
            <p class="card-description">Meditative devotionals for deepening your personal prayer life.</p>
            <div class="card-meta">
              <span class="material-icons-round">auto_stories</span>
              25 devotionals
            </div>
          </div>
        </div>
        
        <div class="card" data-card-id="Promises of God Devotional">
          <button class="favorite-button" aria-label="Add Promises of God Devotional to favorites" aria-pressed="false">
            <span class="material-icons-round">favorite_border</span>
          </button>
          <div class="card-image">
            <img loading="lazy" src="https://images.unsplash.com/photo-1501612780327-45045538702b?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60" alt="Promises of God" onerror="this.style.display='none'; this.parentNode.innerHTML = '<span class=\'material-icons-round placeholder-icon\'>verified</span>'">
          </div>
          <div class="card-content">
            <h5 class="card-title">Promises of God</h5>
            <p class="card-description">Exploring the faithful promises of God throughout Scripture.</p>
            <div class="card-meta">
              <span class="material-icons-round">auto_stories</span>
              20 devotionals
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
  
  <nav class="bottom-nav" role="navigation">
    <a href="#" class="nav-item active" id="nav-explore" aria-current="page">
      <span class="material-icons-round">explore</span>
      Explore
    </a>
    <a href="#" class="nav-item" id="nav-search">
      <span class="material-icons-round">search</span>
      Search
    </a>
    <a href="#" class="nav-item" id="nav-bible">
      <span class="material-icons-round">menu_book</span>
      Bible
    </a>
    <a href="#" class="nav-item" id="nav-sabbath">
      <span class="material-icons-round">book</span>
      Sabbath School Book
    </a>
    <a href="#" class="nav-item" id="nav-notes">
      <span class="material-icons-round">note</span>
      Notes
    </a>
  </nav>
  
  <div class="bible-modal" id="bibleModal" role="dialog" aria-modal="true" aria-labelledby="bibleModalTitle">
    <div class="modal-header">
      <h4 class="modal-title" id="bibleModalTitle">Bible</h4>
      <button class="modal-close" aria-label="Close modal">
        <span class="material-icons-round">close</span>
      </button>
    </div>
    <div class="modal-content">
      <div class="bible-iframe-container">
        <iframe id="bibleIframe" class="bible-iframe" src="https://www.bible.com/bible/111/JHN.1.NIV"></iframe>
      </div>
    </div>
  </div>
  
  <div class="search-modal" id="searchModal" role="dialog" aria-modal="true" aria-labelledby="searchModalTitle">
    <div class="modal-header">
      <h4 class="modal-title" id="searchModalTitle">Search</h4>
      <button class="modal-close" aria-label="Close modal">
        <span class="material-icons-round">close</span>
      </button>
    </div>
    <div class="modal-content">
      <div class="search-input-container">
        <span class="material-icons-round search-icon">search</span>
        <input type="text" id="searchInput" class="search-input" placeholder="Search for courses, topics, or devotionals..." aria-label="Search for courses, topics, or devotionals">
      </div>
      
      <div class="search-results-info">
        <span id="resultsCount">0</span> results found
      </div>
      
      <div class="search-results-grid" id="searchResultsGrid">
         <div class="skeleton-loader-grid" id="searchSkeletonGrid" style="display: none;">
            <div class="card skeleton-card">
                <div class="skeleton skeleton-image"></div>
                <div class="skeleton-content">
                    <div class="skeleton skeleton-title"></div>
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text-short"></div>
                    <div class="skeleton skeleton-meta"></div>
                </div>
            </div>
            <div class="card skeleton-card">
                <div class="skeleton skeleton-image"></div>
                <div class="skeleton-content">
                    <div class="skeleton skeleton-title"></div>
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text-short"></div>
                    <div class="skeleton skeleton-meta"></div>
                </div>
            </div>
             <div class="card skeleton-card">
                <div class="skeleton skeleton-image"></div>
                <div class="skeleton-content">
                    <div class="skeleton skeleton-title"></div>
                    <div class="skeleton skeleton-text"></div>
                    <div class="skeleton skeleton-text-short"></div>
                    <div class="skeleton skeleton-meta"></div>
                </div>
            </div>
        </div>
      </div>
      
      <div class="search-empty-state" id="noResults">
        <span class="material-icons-round" style="font-size: 5rem; opacity: 0.4;">manage_search</span>
        <h4 class="search-empty-title" style="margin-top: var(--spacing-sm);">Oops! Nothing Found Here</h4>
        <p class="search-empty-message">Sorry, we couldn't find anything matching your search. Try a different term like 'faith' or 'grace', or browse our categories.</p>
        <button class="button-primary" id="browseCategoriesButton" style="margin-top: var(--spacing-md);">Browse Categories</button>
      </div>
    </div>
  </div>
  
  <div class="notes-modal" id="notesModal" role="dialog" aria-modal="true" aria-labelledby="notesModalTitle">
    <div class="modal-header">
      <h4 class="modal-title" id="notesModalTitle">Notes</h4>
      <button class="modal-close" aria-label="Close modal">
        <span class="material-icons-round">close</span>
      </button>
    </div>
    <div class="modal-content">
      <div class="notes-sidebar">
        <div class="notes-controls">
          <input type="text" id="notesSearchInput" class="notes-search-input" placeholder="Search notes..." aria-label="Search your notes">
          <div id="allTagsArea">
            <h6>Filter by Tag:</h6>
            <div id="tagPillsContainer">
              <!-- Tag pills will be dynamically inserted here -->
            </div>
            <button id="clearTagFilterBtn" aria-label="Clear tag filter">Clear Filter</button>
          </div>
        </div>
        <div class="notes-list" id="notesListContainer">
           <div class="skeleton-loader-list" id="notesSkeletonList" style="display: none;">
                <div class="note-item skeleton-note-item">
                    <div class="skeleton skeleton-note-title"></div>
                    <div class="skeleton skeleton-note-preview"></div>
                    <div class="skeleton skeleton-note-date"></div>
                </div>
                <div class="note-item skeleton-note-item">
                    <div class="skeleton skeleton-note-title"></div>
                    <div class="skeleton skeleton-note-preview"></div>
                    <div class="skeleton skeleton-note-date"></div>
                </div>
                 <div class="note-item skeleton-note-item">
                    <div class="skeleton skeleton-note-title"></div>
                    <div class="skeleton skeleton-note-preview"></div>
                    <div class="skeleton skeleton-note-date"></div>
                </div>
            </div>
          <!-- Note items will be dynamically inserted here by JS -->
        </div>
         <div class="notes-empty-state" id="noNotesState" style="display: none; padding: var(--spacing-xl); text-align: center;">
            <span class="material-icons-round" style="font-size: 5rem; opacity: 0.4;">note_add</span>
            <h4 class="notes-empty-title" style="margin-top: var(--spacing-sm);">No Notes Yet?</h4>
            <p class="notes-empty-message">It looks a bit empty here. Why not create your first note to capture your thoughts or study insights?</p>
            <button class="button-primary" id="createNewNoteButton" style="margin-top: var(--spacing-md);">Create New Note</button>
        </div>
      </div>
      <div class="notes-content" id="notesContentArea">
        <div class="note-editor">
          <input type="text" id="noteEditorTitle" class="note-editor-title" value="Sermon Reflections" aria-label="Note title">
          <div id="noteTagInputContainer">
            <input type="text" id="noteTagInput" placeholder="Add tags (e.g., sermon, prayer)..." aria-label="Add tags to note">
            <div id="currentNoteTags">
              <!-- Current note's tags will be displayed here as pills -->
            </div>
          </div>
          <textarea id="noteEditorBody" class="note-editor-body" aria-label="Note content">Today's sermon on the prodigal son really spoke to me. The pastor highlighted how the father's unconditional love mirrors God's love for us...</textarea>
        </div>
      </div>
    </div>
  </div>
  
  <div class="sabbath-modal" id="sabbathModal" role="dialog" aria-modal="true" aria-labelledby="sabbathModalTitle">
    <div class="modal-header">
      <h4 class="modal-title" id="sabbathModalTitle">Sabbath School Book</h4>
      <button class="modal-close" aria-label="Close modal">
        <span class="material-icons-round">close</span>
      </button>
    </div>
    <div class="modal-content">
      <div class="sabbath-sidebar">
        <div class="sabbath-quarters">
          <select id="sabbathQuarterSelect" class="sabbath-quarter-select" aria-label="Select Sabbath School Quarter">
            <option>Q2 2023: Romans - Justified by Faith</option>
            <option>Q1 2023: Managing for the Master</option>
            <option>Q4 2022: On Death, Dying, and the Future Hope</option>
          </select>
        </div>
        <div class="sabbath-lessons">
          <div class="sabbath-lesson active">
            <div class="sabbath-lesson-title">Lesson 1: The Apostle Paul in Rome</div>
            <div class="sabbath-lesson-date">April 1-7, 2023</div>
          </div>
          <div class="sabbath-lesson">
            <div class="sabbath-lesson-title">Lesson 2: The Law of God</div>
            <div class="sabbath-lesson-date">April 8-14, 2023</div>
          </div>
        </div>
      </div>
      <div class="sabbath-content">
        <div class="sabbath-day">
          <h3 class="sabbath-day-title">Sunday: Introduction to Romans</h3>
          <div class="sabbath-day-content">
            <p>The book of Romans, written by the apostle Paul around A.D. 57, is considered by many to be the most systematic presentation of Christian doctrine in all of Scripture...</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="profile-modal" id="profileModal" role="dialog" aria-modal="true" aria-labelledby="profileModalTitle">
    <div class="modal-header">
      <h4 class="modal-title" id="profileModalTitle">Profile</h4>
      <button class="modal-close" aria-label="Close modal">
        <span class="material-icons-round">close</span>
      </button>
    </div>
    <div class="modal-content" style="padding: var(--spacing-lg);">
      <p>User profile information and settings will go here.</p>
      <button class="button-primary" style="background-color: var(--primary); color: var(--text-on-primary); border:none; border-radius: var(--radius-sm);">Login/Sign Up</button>
      <p style="margin-top: var(--spacing-md); font-size: 0.875rem; color: var(--text-tertiary);">
        This is a placeholder for user account features. Future updates will include login, profile management, saved preferences, and group functionalities.
      </p>
    </div>
  </div>

  <div class="favorites-modal" id="favoritesModal" role="dialog" aria-modal="true" aria-labelledby="favoritesModalTitle">
    <div class="modal-header">
      <h4 class="modal-title" id="favoritesModalTitle">My Favorites</h4>
      <button class="modal-close" aria-label="Close modal">
        <span class="material-icons-round">close</span>
      </button>
    </div>
    <div class="modal-content">
        <div class="favorites-grid" id="favoritesGrid">
            <!-- Favorite cards will be dynamically inserted here -->
        </div>
        <div class="favorites-empty-state" id="noFavoritesState" style="display: none;">
            <span class="material-icons-round" style="font-size: 5rem; opacity: 0.4;">favorite_border</span>
            <h4 class="favorites-empty-title" style="margin-top: var(--spacing-sm);">No Favorites Yet</h4>
            <p class="favorites-empty-message">You haven't favorited anything yet. Look for the heart icon on content to save it here!</p>
             <button class="button-primary" id="exploreContentButton" style="margin-top: var(--spacing-md);">Explore Content</button>
        </div>
    </div>
  </div>

  <button id="scrollToTopBtn" aria-label="Scroll to top">
    <span class="material-icons-round">arrow_upward</span>
  </button>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const loadingScreen = document.getElementById('loading-screen');
      const themeToggleButton = document.getElementById('theme-toggle');
      const themeToggleIcon = themeToggleButton.querySelector('.material-icons-round');

      function applyTheme(theme) {
        const isDark = theme === 'dark';
        document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
        if (themeToggleIcon) themeToggleIcon.textContent = isDark ? 'dark_mode' : 'light_mode';
        if (themeToggleButton) {
            themeToggleButton.setAttribute('aria-pressed', isDark.toString());
            themeToggleButton.setAttribute('aria-label', isDark ? 'Switch to light mode' : 'Switch to dark mode');
        }
      }

      function setThemePreference(theme) {
        applyTheme(theme);
        localStorage.setItem('theme', theme);
      }

      const savedTheme = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      applyTheme(savedTheme || (prefersDark ? 'dark' : 'light'));

      const bibleModal = document.getElementById('bibleModal');
      const bibleIframe = document.getElementById('bibleIframe');
      const searchModal = document.getElementById('searchModal');
      const searchInput = document.getElementById('searchInput');
      const searchResultsGrid = document.getElementById('searchResultsGrid');
      const resultsCount = document.getElementById('resultsCount');
      const noResults = document.getElementById('noResults');
      
      const notesModal = document.getElementById('notesModal');
      const notesListContainer = document.getElementById('notesListContainer');
      const notesSearchInput = document.getElementById('notesSearchInput');
      const noteEditorTitle = document.getElementById('noteEditorTitle');
      const noteEditorBody = document.getElementById('noteEditorBody');
      const noNotesState = document.getElementById('noNotesState');
      const notesContentArea = document.getElementById('notesContentArea');
      const noteTagInput = document.getElementById('noteTagInput');
      const currentNoteTagsContainer = document.getElementById('currentNoteTags');
      const allTagsPillsContainer = document.getElementById('tagPillsContainer');
      const clearTagFilterBtn = document.getElementById('clearTagFilterBtn');


      const sabbathModal = document.getElementById('sabbathModal');
      const navExplore = document.getElementById('nav-explore');
      const navSearch = document.getElementById('nav-search');
      const navBible = document.getElementById('nav-bible');
      const navNotes = document.getElementById('nav-notes');
      const navSabbath = document.getElementById('nav-sabbath');
      const navExploreIcon = navExplore.querySelector('.material-icons-round');
      const navSearchIcon = navSearch.querySelector('.material-icons-round');
      const navBibleIcon = navBible.querySelector('.material-icons-round');
      const navSabbathIcon = navSabbath.querySelector('.material-icons-round');
      const navNotesIcon = navNotes.querySelector('.material-icons-round');
      const profileButton = document.getElementById('profile-button');
      const profileModal = document.getElementById('profileModal');
      const favoritesHeaderButton = document.getElementById('favorites-header-button');
      const favoritesModal = document.getElementById('favoritesModal');
      const favoritesGrid = document.getElementById('favoritesGrid');
      const noFavoritesState = document.getElementById('noFavoritesState');
      const scrollToTopBtn = document.getElementById('scrollToTopBtn');
      
      // --- START: Skeleton Loader Control ---
      const searchSkeletonGrid = document.getElementById('searchSkeletonGrid');
      const notesSkeletonList = document.getElementById('notesSkeletonList');

      function showSearchSkeleton(show) {
          if (searchSkeletonGrid) searchSkeletonGrid.style.display = show ? 'grid' : 'none';
          if (searchResultsGrid) searchResultsGrid.style.display = show ? 'none' : 'grid'; // Opposite
          if (noResults) noResults.style.display = 'none'; // Hide empty state during skeleton
      }

      function showNotesSkeleton(show) {
          if (notesSkeletonList) notesSkeletonList.style.display = show ? 'flex' : 'none';
          // Ensure main notes list container visibility is handled correctly
          if (notesListContainer) {
            // Hide or show actual list based on skeleton, but also consider empty state
             if (show) {
                notesListContainer.style.display = 'none';
             } else if (noNotesState.style.display !== 'flex') { // only show if not in empty state
                notesListContainer.style.display = 'block';
             }
          }
          if (noNotesState) noNotesState.style.display = 'none'; // Hide empty state during skeleton
      }
      // --- END: Skeleton Loader Control ---

      const iconStates = {
          explore: { selfActive: 'explore', selfInactiveDueToOtherModal: 'explore_off' },
          search:  { active: 'manage_search', inactive: 'search' },
          bible:   { active: 'auto_stories', inactive: 'menu_book' },
          sabbath: { active: 'class', inactive: 'book' },
          notes:   { active: 'edit_note', inactive: 'note' }
      };

      function updateNavIcons(activeNavItemId) {
          navExploreIcon.textContent = (activeNavItemId === 'nav-explore' || activeNavItemId === null) ? iconStates.explore.selfActive : iconStates.explore.selfInactiveDueToOtherModal;
          navSearchIcon.textContent =  (activeNavItemId === 'nav-search')  ? iconStates.search.active  : iconStates.search.inactive;
          navBibleIcon.textContent =   (activeNavItemId === 'nav-bible')   ? iconStates.bible.active   : iconStates.bible.inactive;
          navSabbathIcon.textContent = (activeNavItemId === 'nav-sabbath') ? iconStates.sabbath.active : iconStates.sabbath.inactive;
          navNotesIcon.textContent =   (activeNavItemId === 'nav-notes')   ? iconStates.notes.active   : iconStates.notes.inactive;
      }

      const allNavItems = [navExplore, navSearch, navBible, navNotes, navSabbath];
      const allModalsMap = {
          'nav-search': { navItem: navSearch, modal: searchModal, inputToFocus: searchInput },
          'nav-bible':  { navItem: navBible, modal: bibleModal },
          'nav-notes':  { navItem: navNotes, modal: notesModal },
          'nav-sabbath':{ navItem: navSabbath, modal: sabbathModal },
          'profile':    { modal: profileModal },
          'favorites':  { modal: favoritesModal, headerButton: favoritesHeaderButton }
      };
      let currentOpenModalContent = null; // To track active modal for scroll-to-top

      function setActiveNav(activeItem) {
          allNavItems.forEach(item => {
            item.classList.remove('active');
            item.removeAttribute('aria-current');
          });
          if (activeItem) { 
            activeItem.classList.add('active');
            activeItem.setAttribute('aria-current', 'page');
            updateNavIcons(activeItem.id);
          } else {
            updateNavIcons(null); 
          }
      }

      function openModal(modalToOpen, navItemForModal, inputToFocus = null) {
          Object.values(allModalsMap).forEach(mInfo => {
              if (mInfo.modal !== modalToOpen) {
                  mInfo.modal.classList.remove('open');
              }
          });
          modalToOpen.classList.add('open');
          setActiveNav(navItemForModal); 
          if (inputToFocus) {
              setTimeout(() => inputToFocus.focus(), 50); // Slight delay for transition
          }
          currentOpenModalContent = modalToOpen.querySelector('.modal-content');
          checkScroll(currentOpenModalContent || window); // Check scroll for new modal
      }

      function closeSpecificModal(modalToClose) {
          modalToClose.classList.remove('open');
          setActiveNav(navExplore); 
          currentOpenModalContent = null;
          checkScroll(window); // Check scroll for main window
      }

      navExplore.addEventListener('click', function(e) {
          e.preventDefault();
          Object.values(allModalsMap).forEach(mInfo => mInfo.modal.classList.remove('open'));
          setActiveNav(navExplore);
          window.scrollTo(0, 0);
          currentOpenModalContent = null;
          checkScroll(window);
      });
      
      Object.entries(allModalsMap).forEach(([key, itemInfo]) => { 
          const triggerElement = itemInfo.navItem || itemInfo.headerButton; // Use headerButton for favorites
          if (triggerElement) { 
              triggerElement.addEventListener('click', function(e) {
                  e.preventDefault();
                  if (itemInfo.modal.classList.contains('open')) {
                      itemInfo.modal.classList.remove('open');
                      setActiveNav(navExplore);
                      currentOpenModalContent = null;
                      checkScroll(window);
                  } else {
                      // Close other main modals if they are open
                      Object.values(allModalsMap).forEach(m => {
                          if (m.modal !== itemInfo.modal && m.modal.classList.contains('open')) {
                              m.modal.classList.remove('open');
                          }
                      });
                      openModal(itemInfo.modal, itemInfo.navItem, itemInfo.inputToFocus);
                      
                      if (key === 'nav-search' && searchInput.value === '') {
                          showSearchSkeleton(true);
                          setTimeout(() => { // Simulate fetch
                              showSearchSkeleton(false);
                              if(noResults) noResults.style.display = 'flex'; 
                              if(resultsCount) resultsCount.textContent = 0;
                              if(searchResultsGrid) searchResultsGrid.innerHTML = '';
                          }, 700);
                      } else if (key === 'nav-notes') {
                          renderNotesList(); // This will handle empty state and skeleton internally
                          renderAllTags();
                      } else if (key === 'favorites') {
                          renderFavorites();
                      }
                  }
              });
          }

          const closeButton = itemInfo.modal.querySelector('.modal-close'); 
          if (closeButton) {
              closeButton.addEventListener('click', function() {
                  closeSpecificModal(itemInfo.modal); 
              });
          }
      });

      profileButton.addEventListener('click', (e) => {
          e.preventDefault();
          if (profileModal.classList.contains('open')) {
              profileModal.classList.remove('open');
              setActiveNav(navExplore); 
              currentOpenModalContent = null;
              checkScroll(window);
          } else {
              Object.values(allModalsMap).forEach(mInfo => {
                  if (mInfo.modal !== profileModal && mInfo.modal.classList.contains('open')) { 
                      mInfo.modal.classList.remove('open');
                  }
              });
              profileModal.classList.add('open');
              setActiveNav(null);
              currentOpenModalContent = profileModal.querySelector('.modal-content');
              checkScroll(currentOpenModalContent || window);
          }
      });
      
      setActiveNav(navExplore);
      
      const versionButton = document.createElement('button');
      versionButton.className = 'version-button';
      versionButton.innerHTML = 'Version: NIV <span class="material-icons-round">arrow_drop_down</span>';
      const versionSelector = document.createElement('div');
      versionSelector.className = 'version-selector';
      const versionTabs = document.createElement('div');
      versionTabs.className = 'version-tabs';
      const preferredTab = document.createElement('button');
      preferredTab.className = 'version-tab active';
      preferredTab.textContent = 'Preferred';
      const englishTab = document.createElement('button');
      englishTab.className = 'version-tab';
      englishTab.textContent = 'English';
      const allTab = document.createElement('button');
      allTab.className = 'version-tab';
      allTab.textContent = 'All Versions';
      versionTabs.append(preferredTab, englishTab, allTab);
      const versionSearchContainer = document.createElement('div');
      versionSearchContainer.className = 'version-search';
      versionSearchContainer.innerHTML = '<input type="text" placeholder="Search versions..." aria-label="Search Bible versions">';
      const versionList = document.createElement('div');
      versionList.className = 'version-list';
      const preferredVersions = [
        { abbr: 'NIV', name: 'New International Version', url: 'https://www.bible.com/bible/111/JHN.1.NIV' },
        { abbr: 'KJV', name: 'King James Version', url: 'https://www.bible.com/bible/1/JHN.1.KJV' },
        { abbr: 'NLT', name: 'New Living Translation', url: 'https://www.bible.com/bible/116/JHN.1.NLT' },
      ];
      const englishVersions = preferredVersions; 
      const allVersions = preferredVersions; 
      
      function populateVersionList(versionsToShow, isPreferred = false) {
        versionList.innerHTML = '';
        versionsToShow.forEach(version => {
          const versionItem = document.createElement('button');
          versionItem.className = 'version-item' + (isPreferred ? ' preferred' : '');
          versionItem.innerHTML = `<span class="version-abbr">${version.abbr}</span><span class="version-name">${version.name}</span>`;
          versionItem.addEventListener('click', function() {
            bibleIframe.src = version.url;
            versionSelector.style.display = 'none';
            versionButton.innerHTML = `Version: ${version.abbr} <span class="material-icons-round">arrow_drop_down</span>`;
          });
          versionList.appendChild(versionItem);
        });
      }
      
      populateVersionList(preferredVersions, true); 
      versionSelector.append(versionTabs, versionSearchContainer, versionList);
      versionButton.addEventListener('click', () => {
        versionSelector.style.display = (versionSelector.style.display === 'none' || versionSelector.style.display === '') ? 'block' : 'none';
      });
      [preferredTab, englishTab, allTab].forEach(tab => {
        tab.addEventListener('click', function() {
            [preferredTab, englishTab, allTab].forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            if(this === preferredTab) populateVersionList(preferredVersions, true);
            else if (this === englishTab) populateVersionList(englishVersions);
            else if (this === allTab) populateVersionList(allVersions);
        });
      });
      
      bibleModal.querySelector('.modal-header').appendChild(versionButton);
      bibleModal.querySelector('.modal-content').appendChild(versionSelector);
      const guidanceMessage = document.createElement('div');
      guidanceMessage.className = 'guidance-message';
      guidanceMessage.textContent = 'Tap anywhere to navigate or use the version selector in the top-right';
      bibleModal.querySelector('.modal-content').appendChild(guidanceMessage);
      
      navBible.addEventListener('click', function(e) { 
        if (!bibleModal.classList.contains('open')) { 
            setTimeout(() => {
                if(bibleModal.classList.contains('open')) {
                    guidanceMessage.style.opacity = '1';
                    setTimeout(() => { guidanceMessage.style.opacity = '0'; }, 3000);
                }
            }, 50); 
        }
      });

      searchInput.addEventListener('input', function() {
        const query = this.value.toLowerCase().trim();
        
        if (query.length > 0) {
            showSearchSkeleton(true); 
            searchResultsGrid.innerHTML = ''; 

            setTimeout(() => { // Simulate API call / filtering
                const allCardsContent = Array.from(document.querySelectorAll('main .card')).map(card => ({
                    id: card.dataset.cardId,
                    title: card.querySelector('.card-title')?.textContent || '',
                    description: card.querySelector('.card-description')?.textContent || '',
                    image: card.querySelector('.card-image img')?.src || null,
                    placeholderIcon: card.querySelector('.card-image .placeholder-icon')?.textContent || 'menu_book',
                    meta: card.querySelector('.card-meta')?.innerHTML || '',
                    isFavorited: getFavorites().some(fav => fav.id === card.dataset.cardId)
                }));

                const filteredContent = allCardsContent.filter(item => 
                  item.title.toLowerCase().includes(query) || 
                  item.description.toLowerCase().includes(query)
                );
                
                resultsCount.textContent = filteredContent.length;
                
                if (filteredContent.length === 0) {
                    noResults.style.display = 'flex';
                } else {
                    noResults.style.display = 'none';
                    filteredContent.forEach(itemData => {
                        const card = createContentCard(itemData);
                        searchResultsGrid.appendChild(card);
                    });
                }
                showSearchSkeleton(false); 
            }, 700); 
        } else {
            searchResultsGrid.innerHTML = '';
            resultsCount.textContent = 0;
            noResults.style.display = 'flex';
            showSearchSkeleton(true); 
        }
      });
      if(noResults) noResults.style.display = 'flex'; 
      if(resultsCount) resultsCount.textContent = 0;
      if(searchSkeletonGrid && searchInput.value === '') showSearchSkeleton(true);

      // --- Notes Data and Functions ---
      let notesData = [
        { id: 'note1', title: "Sermon Reflections", preview: "Today's sermon on the prodigal son really spoke to me...", date: "May 15, 2023", content: "Today's sermon on the prodigal son really spoke to me. The pastor highlighted how the father's unconditional love mirrors God's love for us.\n\nKey points:\n- The son's rebellion represents our turning away from God\n- The father's waiting represents God's patience\n- The celebration represents God's joy when we return\n\nQuestions to reflect on:\n1. In what ways have I been like the prodigal son?\n2. How can I better appreciate God's unconditional love?\n3. Am I ever like the older brother, resentful of God's grace to others?\n\nScripture references:\n- Luke 15:11-32\n- Ephesians 2:4-5\n- Romans 5:8\n\nAction steps:\n- Meditate on God's unconditional love this week\n- Reach out to someone who might feel distant from God\n- Practice gratitude for God's patience with me", tags: ["sermon", "reflection", "luke"] },
        { id: 'note2', title: "Prayer Requests", preview: "1. Healing for Mom's surgery 2. Wisdom for career decision...", date: "May 10, 2023", content: "Prayer Requests:\n1. Healing for Mom's surgery - that it goes well and recovery is swift.\n2. Wisdom for career decision - clarity on whether to take the new job offer.\n3. Strength for John as he faces exams.\n4. Thanksgiving for answered prayer regarding Sarah's health.", tags: ["prayer", "family", "healing"] },
        { id: 'note3', title: "Bible Study - Romans", preview: "Key themes in Romans: righteousness, justification, sanctification...", date: "May 5, 2023", content: "Bible Study - Romans Chapters 1-3:\nKey themes:\n- Righteousness of God\n- Justification by faith\n- Sinfulness of humanity (both Jew and Gentile)\n- God's wrath against sin\n\nImportant verses:\n- Romans 1:16-17\n- Romans 3:23-24\n\nInsights:\n- No one is righteous on their own.\n- Salvation is a gift received through faith in Jesus Christ.", tags: ["bible study", "romans", "theology", "justification"] },
        { id: 'note4', title: "Worship Song Ideas", preview: "Songs for next Sunday: 1. How Great Thou Art 2. Amazing Grace...", date: "April 28, 2023", content: "Worship Song Ideas for Next Sunday:\nTheme: God's Faithfulness\n\n1. How Great Thou Art\n2. Amazing Grace (My Chains Are Gone)\n3. Great Is Thy Faithfulness\n4. Way Maker\n5. Goodness of God\n\nConsider a call to worship from Psalm 100.", tags: ["worship", "music", "planning"] }
      ];
      let currentNoteId = notesData.length > 0 ? notesData[0].id : null;
      let activeTagFilter = null;

      function renderNotesList(notesToDisplay = notesData) {
          showNotesSkeleton(true);
          notesListContainer.innerHTML = ''; // Clear existing notes first

          setTimeout(() => { // Simulate loading
              if (notesToDisplay.length === 0 && !notesSearchInput.value && !activeTagFilter) {
                  noNotesState.style.display = 'flex';
                  notesContentArea.style.display = 'none';
                  notesListContainer.style.display = 'none';
              } else {
                  noNotesState.style.display = 'none';
                  notesContentArea.style.display = 'flex'; // Show editor if there are notes or search/filter is active
                  notesListContainer.style.display = 'block';

                  notesToDisplay.forEach(note => {
                      const noteItem = document.createElement('div');
                      noteItem.className = 'note-item';
                      noteItem.dataset.noteId = note.id;
                      if (note.id === currentNoteId) {
                          noteItem.classList.add('active');
                      }
                      const tagsPreview = note.tags.length > 0 
                          ? `<div class="note-tags-preview">Tags: ${note.tags.slice(0, 3).join(', ')}${note.tags.length > 3 ? '...' : ''}</div>` 
                          : '';
                      noteItem.innerHTML = `
                          <div class="note-title">${note.title}</div>
                          <div class="note-preview">${note.preview}</div>
                          <div class="note-date">${note.date}</div>
                          ${tagsPreview}
                      `;
                      noteItem.addEventListener('click', () => loadNoteIntoEditor(note.id));
                      notesListContainer.appendChild(noteItem);
                  });
              }
              showNotesSkeleton(false);
              if (notesToDisplay.length > 0 && currentNoteId) {
                  loadNoteIntoEditor(currentNoteId); // Ensure editor updates if list changes
              } else if (notesToDisplay.length === 0 && (notesSearchInput.value || activeTagFilter)) {
                  // If search/filter yields no results, show a specific empty state for that
                  notesListContainer.innerHTML = `<p style="padding: var(--spacing-md); text-align: center; color: var(--text-tertiary);">No notes match your criteria.</p>`;
                  notesContentArea.style.display = 'none'; // Hide editor if no notes match
              }

          }, 300); // Short delay for skeleton
      }
      
      function loadNoteIntoEditor(noteId) {
          const note = notesData.find(n => n.id === noteId);
          if (note) {
              currentNoteId = note.id;
              noteEditorTitle.value = note.title;
              noteEditorBody.value = note.content;
              renderCurrentNoteTags(note.tags);

              document.querySelectorAll('.note-item').forEach(item => item.classList.remove('active'));
              const activeItem = notesListContainer.querySelector(`.note-item[data-note-id="${noteId}"]`);
              if (activeItem) activeItem.classList.add('active');
              notesContentArea.style.display = 'flex';
          }
      }

      function renderCurrentNoteTags(tags = []) {
          currentNoteTagsContainer.innerHTML = '';
          tags.forEach(tag => {
              const tagPill = document.createElement('button');
              tagPill.className = 'tag-pill';
              tagPill.type = 'button';
              tagPill.textContent = tag;
              tagPill.setAttribute('aria-label', `Remove tag ${tag}`);
              const removeIcon = document.createElement('span');
              removeIcon.className = 'material-icons-round remove-tag-icon';
              removeIcon.textContent = 'close';
              removeIcon.setAttribute('aria-hidden', 'true');
              tagPill.appendChild(removeIcon);
              
              tagPill.addEventListener('click', () => {
                  removeTagFromCurrentNote(tag);
              });
              currentNoteTagsContainer.appendChild(tagPill);
          });
      }

      noteTagInput.addEventListener('keypress', function(e) {
          if (e.key === 'Enter' || e.key === ',') {
              e.preventDefault();
              const newTag = this.value.trim().toLowerCase();
              if (newTag && currentNoteId) {
                  addTagToCurrentNote(newTag);
                  this.value = '';
              }
          }
      });

      function addTagToCurrentNote(tag) {
          const note = notesData.find(n => n.id === currentNoteId);
          if (note && !note.tags.includes(tag)) {
              note.tags.push(tag);
              renderCurrentNoteTags(note.tags);
              renderAllTags(); // Update global tag list
              renderNotesList(getFilteredNotes()); // Re-render list to show updated tags preview
          }
      }

      function removeTagFromCurrentNote(tagToRemove) {
          const note = notesData.find(n => n.id === currentNoteId);
          if (note) {
              note.tags = note.tags.filter(tag => tag !== tagToRemove);
              renderCurrentNoteTags(note.tags);
              renderAllTags(); // Update global tag list
              renderNotesList(getFilteredNotes()); // Re-render list to show updated tags preview
          }
      }

      function getUniqueTags() {
          const allTags = new Set();
          notesData.forEach(note => note.tags.forEach(tag => allTags.add(tag)));
          return Array.from(allTags).sort();
      }

      function renderAllTags() {
          const uniqueTags = getUniqueTags();
          allTagsPillsContainer.innerHTML = '';
          if (uniqueTags.length === 0) {
             allTagsPillsContainer.innerHTML = `<p style="font-size: 0.8rem; color: var(--text-tertiary);">No tags yet. Add tags to your notes to filter them here.</p>`;
             clearTagFilterBtn.style.display = 'none';
             return;
          }

          uniqueTags.forEach(tag => {
              const tagPill = document.createElement('button');
              tagPill.className = 'tag-pill';
              tagPill.type = 'button';
              tagPill.textContent = tag;
              tagPill.dataset.tag = tag;
              if (tag === activeTagFilter) {
                  tagPill.classList.add('active-filter');
              }
              tagPill.addEventListener('click', () => {
                  toggleTagFilter(tag);
              });
              allTagsPillsContainer.appendChild(tagPill);
          });
          clearTagFilterBtn.style.display = activeTagFilter ? 'inline-block' : 'none';
      }
      
      function toggleTagFilter(tag) {
          notesSearchInput.value = ''; // Clear search when filtering by tag
          if (activeTagFilter === tag) {
              activeTagFilter = null; // Deselect if already active
          } else {
              activeTagFilter = tag;
          }
          renderNotesList(getFilteredNotes());
          renderAllTags(); // To update active state of pills
      }

      clearTagFilterBtn.addEventListener('click', () => {
          activeTagFilter = null;
          notesSearchInput.value = '';
          renderNotesList(getFilteredNotes());
          renderAllTags();
      });

      notesSearchInput.addEventListener('input', () => {
          activeTagFilter = null; // Clear tag filter when searching
          renderNotesList(getFilteredNotes());
          renderAllTags(); // Update tag pills if needed (e.g., remove active state)
      });

      function getFilteredNotes() {
          let filtered = notesData;
          const searchTerm = notesSearchInput.value.toLowerCase().trim();

          if (activeTagFilter) {
              filtered = filtered.filter(note => note.tags.includes(activeTagFilter));
          }
          if (searchTerm) {
              filtered = filtered.filter(note => 
                  note.title.toLowerCase().includes(searchTerm) ||
                  note.preview.toLowerCase().includes(searchTerm) ||
                  note.content.toLowerCase().includes(searchTerm) ||
                  note.tags.some(tag => tag.toLowerCase().includes(searchTerm))
              );
          }
          return filtered;
      }


      // --- START: Enhanced Empty State Buttons ---
      const browseCategoriesButton = document.getElementById('browseCategoriesButton');
      const createNewNoteButton = document.getElementById('createNewNoteButton');
      const exploreContentFavoritesButton = document.getElementById('exploreContentButton');


      if (browseCategoriesButton) {
          browseCategoriesButton.addEventListener('click', () => {
              closeSpecificModal(searchModal);
              navExplore.click(); 
          });
      }
      if (exploreContentFavoritesButton) {
          exploreContentFavoritesButton.addEventListener('click', () => {
              closeSpecificModal(favoritesModal);
              navExplore.click(); 
          });
      }

      if (createNewNoteButton) {
          createNewNoteButton.addEventListener('click', () => {
              // Logic to create a new note (simplified: add to notesData and render)
              const newNoteId = `note${Date.now()}`;
              const newNote = {
                  id: newNoteId,
                  title: "New Note",
                  preview: "Start writing your new note here...",
                  date: new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' }),
                  content: "",
                  tags: []
              };
              notesData.unshift(newNote); // Add to the beginning
              currentNoteId = newNoteId; // Set as active
              
              renderNotesList(); // Re-render the list (will show the new note)
              loadNoteIntoEditor(newNoteId); // Load the new note into the editor
              renderAllTags(); // Update available tags

              notesContentArea.style.display = 'flex';
              noNotesState.style.display = 'none';
              notesListContainer.style.display = 'block';
              
              setTimeout(() => noteEditorTitle.focus(), 50);
          });
      }
      // --- END: Enhanced Empty State Buttons ---
      
      themeToggleButton.addEventListener('click', () => {
        const currentDataTheme = document.documentElement.getAttribute('data-theme');
        setThemePreference(currentDataTheme === 'dark' ? 'light' : 'dark');
      });

      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
        if (!localStorage.getItem('theme')) { 
            applyTheme(event.matches ? 'dark' : 'light');
        }
      });

      // --- Favorites ---
      const FAVORITES_KEY = 'theWellAppFavorites';

      function getFavorites() {
          return JSON.parse(localStorage.getItem(FAVORITES_KEY)) || [];
      }

      function saveFavorites(favorites) {
          localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));
          updateFavoritesHeaderIcon(favorites.length);
      }
       function updateFavoritesHeaderIcon(count) {
        const icon = favoritesHeaderButton.querySelector('.material-icons-round');
        if (count > 0) {
            icon.textContent = 'favorite';
        } else {
            icon.textContent = 'favorite_border';
        }
      }


      function createContentCard(itemData, isFavoriteCard = false) {
        const card = document.createElement('div');
        card.className = 'card';
        card.dataset.cardId = itemData.id; // Use a unique ID for the card

        const favoriteButton = document.createElement('button');
        favoriteButton.className = 'favorite-button';
        favoriteButton.setAttribute('aria-pressed', itemData.isFavorited.toString());
        
        const favIcon = document.createElement('span');
        favIcon.className = 'material-icons-round';
        favIcon.textContent = itemData.isFavorited ? 'favorite' : 'favorite_border';
        favoriteButton.appendChild(favIcon);
        favoriteButton.setAttribute('aria-label', itemData.isFavorited ? `Remove ${itemData.title} from favorites` : `Add ${itemData.title} to favorites`);


        favoriteButton.addEventListener('click', (e) => {
            e.stopPropagation(); // Prevent card click if any
            toggleFavorite(itemData, favoriteButton, favIcon, card, isFavoriteCard);
        });
        card.appendChild(favoriteButton);
        
        const cardImageDiv = document.createElement('div');
        cardImageDiv.className = 'card-image';
        if (itemData.image) {
            const img = document.createElement('img');
            img.loading = 'lazy';
            img.src = itemData.image;
            img.alt = itemData.title;
            img.onerror = function() { 
                this.style.display='none'; 
                this.parentNode.innerHTML = `<span class='material-icons-round placeholder-icon'>${itemData.placeholderIcon || 'menu_book'}</span>`;
            };
            cardImageDiv.appendChild(img);
        } else if (itemData.placeholderIcon) {
            cardImageDiv.innerHTML = `<span class='material-icons-round placeholder-icon'>${itemData.placeholderIcon}</span>`;
        } else if (itemData.iframeSrc) { // For video cards
            card.classList.add('video-card'); // Ensure video-card styling if it's a video
            cardImageDiv.classList.add('video-container');
            cardImageDiv.innerHTML = `<iframe src="${itemData.iframeSrc}" title="${itemData.title}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>`;
        }


        const cardContentDiv = document.createElement('div');
        cardContentDiv.className = 'card-content';
        cardContentDiv.innerHTML = `
            <h5 class="card-title">${itemData.title}</h5>
            <p class="card-description">${itemData.description}</p>
            <div class="card-meta">
              ${itemData.meta}
            </div>
        `;
        card.appendChild(cardImageDiv);
        card.appendChild(cardContentDiv);
        return card;
      }
      
      function toggleFavorite(itemData, buttonEl, iconEl, cardEl, isFavoriteCardView) {
          let favorites = getFavorites();
          const itemIndex = favorites.findIndex(fav => fav.id === itemData.id);
          let isNowFavorited;

          if (itemIndex > -1) { // Item is already favorited, so remove it
              favorites.splice(itemIndex, 1);
              isNowFavorited = false;
          } else { // Item is not favorited, so add it
              // Store only necessary data
              const favData = {
                  id: itemData.id, // Essential
                  title: itemData.title,
                  description: itemData.description,
                  image: itemData.image,
                  placeholderIcon: itemData.placeholderIcon,
                  meta: itemData.meta,
                  iframeSrc: itemData.iframeSrc // for video cards
              };
              favorites.push(favData);
              isNowFavorited = true;
          }
          saveFavorites(favorites);

          // Update button state
          buttonEl.setAttribute('aria-pressed', isNowFavorited.toString());
          iconEl.textContent = isNowFavorited ? 'favorite' : 'favorite_border';
          buttonEl.setAttribute('aria-label', isNowFavorited ? `Remove ${itemData.title} from favorites` : `Add ${itemData.title} to favorites`);
          buttonEl.classList.toggle('favorited', isNowFavorited);


          // If in favorites view and unfavorited, remove from view
          if (isFavoriteCardView && !isNowFavorited) {
              cardEl.remove();
              if (favoritesGrid.children.length === 0) {
                  noFavoritesState.style.display = 'flex';
              }
          }
          // Update corresponding card on main page if it exists
          const mainPageCardFavoriteButton = document.querySelector(`.card[data-card-id="${itemData.id}"] .favorite-button`);
          if (mainPageCardFavoriteButton) {
              mainPageCardFavoriteButton.setAttribute('aria-pressed', isNowFavorited.toString());
              mainPageCardFavoriteButton.querySelector('.material-icons-round').textContent = isNowFavorited ? 'favorite' : 'favorite_border';
              mainPageCardFavoriteButton.setAttribute('aria-label', isNowFavorited ? `Remove ${itemData.title} from favorites` : `Add ${itemData.title} to favorites`);
              mainPageCardFavoriteButton.classList.toggle('favorited', isNowFavorited);
          }
      }


      function renderFavorites() {
          const favorites = getFavorites();
          favoritesGrid.innerHTML = '';
          if (favorites.length === 0) {
              noFavoritesState.style.display = 'flex';
          } else {
              noFavoritesState.style.display = 'none';
              favorites.forEach(favData => {
                  const cardDataForRender = {...favData, isFavorited: true}; // Ensure it's marked as favorited
                  const card = createContentCard(cardDataForRender, true); // true for isFavoriteCard
                  favoritesGrid.appendChild(card);
              });
          }
      }

      function initializeFavoriteButtons() {
          const favorites = getFavorites();
          document.querySelectorAll('.card').forEach(cardElement => {
              const cardId = cardElement.dataset.cardId;
              const favButton = cardElement.querySelector('.favorite-button');
              if (!favButton) return; // Should not happen if HTML is correct

              const isFavorited = favorites.some(fav => fav.id === cardId);
              const icon = favButton.querySelector('.material-icons-round');
              
              favButton.setAttribute('aria-pressed', isFavorited.toString());
              icon.textContent = isFavorited ? 'favorite' : 'favorite_border';
              favButton.classList.toggle('favorited', isFavorited);
              const cardTitle = cardElement.querySelector('.card-title')?.textContent || 'this item';
              favButton.setAttribute('aria-label', isFavorited ? `Remove ${cardTitle} from favorites` : `Add ${cardTitle} to favorites`);


              favButton.addEventListener('click', (e) => {
                  e.stopPropagation();
                  const currentCardData = { // Re-fetch or construct card data for toggling
                      id: cardId,
                      title: cardTitle,
                      description: cardElement.querySelector('.card-description')?.textContent || '',
                      image: cardElement.querySelector('.card-image img')?.src || null,
                      placeholderIcon: cardElement.querySelector('.card-image .placeholder-icon')?.textContent || 'menu_book',
                      meta: cardElement.querySelector('.card-meta')?.innerHTML || '',
                      iframeSrc: cardElement.querySelector('.video-container iframe')?.src || null,
                      // isFavorited will be determined by toggleFavorite logic
                  };
                  toggleFavorite(currentCardData, favButton, icon, cardElement, false);
              });
          });
          updateFavoritesHeaderIcon(favorites.length);
      }
      initializeFavoriteButtons();


      // --- Scroll-to-Top Button ---
      function checkScroll(scrollableElement) {
          const scrollTop = (scrollableElement === window) ? scrollableElement.pageYOffset : scrollableElement.scrollTop;
          if (scrollTop > 200) {
              scrollToTopBtn.classList.add('show');
          } else {
              scrollToTopBtn.classList.remove('show');
          }
      }

      window.addEventListener('scroll', () => checkScroll(window));
      // Add scroll listeners for modal content areas when they are opened
      [searchModal, notesModal.querySelector('.notes-content'), notesModal.querySelector('.notes-list'), sabbathModal.querySelector('.sabbath-content'), profileModal, favoritesModal, bibleModal.querySelector('.bible-iframe-container')].forEach(el => {
          if (el) el.addEventListener('scroll', () => checkScroll(el));
      });


      scrollToTopBtn.addEventListener('click', () => {
          const targetElement = currentOpenModalContent || window;
          targetElement.scrollTo({ top: 0, behavior: 'smooth' });
      });


      window.addEventListener('load', () => {
          if (loadingScreen) {
              loadingScreen.classList.add('hidden');
              loadingScreen.addEventListener('transitionend', () => {
                  if (loadingScreen.classList.contains('hidden') && loadingScreen.parentNode) {
                      loadingScreen.parentNode.removeChild(loadingScreen);
                  }
              }, { once: true });
          }
          // Initial notes render
          renderNotesList();
          renderAllTags();
          if (notesData.length > 0) {
             loadNoteIntoEditor(notesData[0].id);
          }
      });

    });
  </script>
</body>
</html>
